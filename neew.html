<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>QUANTUM OS | ULTRA</title>

    <!-- 1. TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            black: '#030305',
                            dark: '#0A0A12',
                            glass: 'rgba(20, 20, 35, 0.6)',
                            neon: '#00F0FF',
                            pink: '#FF003C',
                            purple: '#BD00FF',
                            dim: 'rgba(255,255,255,0.05)'
                        }
                    },
                    fontFamily: {
                        mono: ['"Share Tech Mono"', 'monospace'],
                        sans: ['"Rajdhani"', 'sans-serif'],
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'spin-slow': 'spin 10s linear infinite',
                    }
                }
            }
        }
    </script>

    <!-- 2. FONTS (Sci-Fi) -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <!-- 3. ICONS -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <!-- 4. ANIMATION ENGINES -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <style>
        /* Custom Effects not in Tailwind */
        body { 
            background-color: #030305; 
            overflow: hidden; 
            cursor: crosshair;
        }
        
        /* Scanline Overlay */
        .scanlines {
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            position: fixed;
            pointer-events: none;
            inset: 0;
            z-index: 9999;
            opacity: 0.15;
        }

        /* Holographic Glass */
        .holo-card {
            background: rgba(10, 10, 18, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 0 0 1px rgba(0, 240, 255, 0.05), 0 20px 50px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }
        
        .holo-card:hover {
            border-color: rgba(0, 240, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.2);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #00F0FF; border-radius: 2px; }

        /* Loader Glitch */
        .glitch-text { position: relative; }
        .glitch-text::before, .glitch-text::after {
            content: attr(data-text);
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        }
        .glitch-text::before { left: 2px; text-shadow: -1px 0 #ff00c1; clip: rect(44px, 450px, 56px, 0); animation: glitch-anim 5s infinite linear alternate-reverse; }
        .glitch-text::after { left: -2px; text-shadow: -1px 0 #00fff9; clip: rect(44px, 450px, 56px, 0); animation: glitch-anim2 5s infinite linear alternate-reverse; }
        
        @keyframes glitch-anim { 0% { clip: rect(12px, 9999px, 32px, 0); } 100% { clip: rect(65px, 9999px, 80px, 0); } }
        @keyframes glitch-anim2 { 0% { clip: rect(85px, 9999px, 15px, 0); } 100% { clip: rect(10px, 9999px, 85px, 0); } }

        /* Floating Animation Class */
        .float-anim { animation: floating 6s ease-in-out infinite; }
        @keyframes floating { 0% { transform: translateY(0px); } 50% { transform: translateY(-15px); } 100% { transform: translateY(0px); } }
    </style>
</head>
<body class="text-white font-sans antialiased selection:bg-cyber-neon selection:text-black">

    <!-- 3D BACKGROUND LAYER -->
    <canvas id="neural-canvas" class="fixed top-0 left-0 w-full h-full -z-10 opacity-60"></canvas>
    
    <!-- CRT OVERLAY -->
    <div class="scanlines"></div>

    <!-- UI WRAPPER -->
    <div id="ui-container" class="relative w-full h-full min-h-screen flex flex-col overflow-hidden">

        <!-- ======================= BOOT SCREEN ======================= -->
        <section id="boot-screen" class="absolute inset-0 z-50 flex flex-col items-center justify-center bg-cyber-black">
            <div class="relative w-64 h-64 mb-8 flex items-center justify-center">
                <div class="absolute inset-0 border-t-2 border-cyber-neon rounded-full animate-spin"></div>
                <div class="absolute inset-4 border-r-2 border-cyber-purple rounded-full animate-spin-slow"></div>
                <div class="text-6xl animate-pulse">⚛</div>
            </div>
            
            <h1 class="text-5xl font-bold font-mono tracking-widest mb-4 glitch-text" data-text="QUANTUM OS">QUANTUM OS</h1>
            
            <div class="w-80 h-1 bg-gray-800 rounded mt-4 overflow-hidden relative">
                <div id="boot-bar" class="h-full bg-gradient-to-r from-cyber-purple to-cyber-neon w-0 shadow-[0_0_10px_#00F0FF]"></div>
            </div>
            
            <div id="boot-log" class="mt-4 font-mono text-xs text-cyber-neon h-6">Initializing Kernel...</div>
        </section>

        <!-- ======================= LOCK SCREEN ======================= -->
        <section id="lock-screen" class="absolute inset-0 z-40 hidden flex-col items-center justify-center backdrop-blur-sm">
            <div class="holo-card p-10 rounded-3xl text-center max-w-sm w-full relative overflow-hidden group">
                <!-- Decorative Elements -->
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-cyber-neon to-transparent opacity-50"></div>
                
                <i class="ri-fingerprint-line text-8xl text-cyber-neon mb-6 block animate-pulse-fast"></i>
                <h2 class="text-2xl font-bold mb-2">IDENTITY VERIFICATION</h2>
                <p class="text-gray-400 text-sm mb-8 font-mono">ENTER QUANTUM PIN</p>
                
                <div class="flex justify-center gap-4 mb-8">
                    <div class="w-4 h-4 rounded-full border border-cyber-neon transition-all duration-300" id="dot-1"></div>
                    <div class="w-4 h-4 rounded-full border border-cyber-neon transition-all duration-300" id="dot-2"></div>
                    <div class="w-4 h-4 rounded-full border border-cyber-neon transition-all duration-300" id="dot-3"></div>
                    <div class="w-4 h-4 rounded-full border border-cyber-neon transition-all duration-300" id="dot-4"></div>
                </div>

                <div class="grid grid-cols-3 gap-3 font-mono">
                    <!-- Keypad generated via JS for cleaner animation control -->
                </div>
            </div>
        </section>

        <!-- ======================= AUTH SCREEN ======================= -->
        <section id="auth-screen" class="absolute inset-0 z-30 hidden flex-col items-center justify-center">
            <div class="holo-card p-12 rounded-3xl text-center max-w-md w-full border-t border-cyber-neon float-anim">
                <div class="mb-6 inline-block p-4 rounded-full bg-cyber-dim border border-cyber-purple/30">
                    <i class="ri-database-2-line text-5xl text-transparent bg-clip-text bg-gradient-to-br from-cyber-neon to-cyber-purple"></i>
                </div>
                <h1 class="text-4xl font-bold mb-2 tracking-tight">DRIVE PRO</h1>
                <p class="text-gray-400 mb-8 font-mono text-sm">SECURE CLOUD UPLINK</p>
                
                <button onclick="QuantumAuth.googleSignIn()" class="group relative w-full py-4 bg-cyber-dim border border-cyber-neon/30 text-cyber-neon font-bold rounded-xl overflow-hidden transition-all hover:bg-cyber-neon/10 hover:border-cyber-neon hover:shadow-[0_0_30px_rgba(0,240,255,0.3)]">
                    <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-cyber-neon/20 to-transparent -translate-x-full group-hover:animate-[shimmer_1s_infinite]"></div>
                    <span class="flex items-center justify-center gap-2">
                        <i class="ri-google-fill text-xl"></i> INITIALIZE LINK
                    </span>
                </button>
            </div>
        </section>

        <!-- ======================= DASHBOARD ======================= -->
        <section id="app-screen" class="absolute inset-0 z-20 hidden flex overflow-hidden">
            
            <!-- Sidebar -->
            <aside class="w-20 lg:w-72 h-full holo-card border-r border-white/10 flex flex-col z-20 transition-all duration-500" id="sidebar">
                <div class="p-6 flex items-center gap-4 border-b border-white/5">
                    <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-cyber-neon to-cyber-purple flex items-center justify-center text-black font-bold text-xl">Q</div>
                    <div class="hidden lg:block">
                        <h3 class="font-bold tracking-wider">QUANTUM</h3>
                        <p class="text-xs text-cyber-neon font-mono">v.2.0.84</p>
                    </div>
                </div>

                <nav class="flex-1 p-4 space-y-2">
                    <a href="#" onclick="QuantumDrive.loadFiles('root')" class="flex items-center gap-4 p-3 rounded-xl hover:bg-white/5 text-gray-300 hover:text-cyber-neon transition-colors group">
                        <i class="ri-hard-drive-2-line text-xl group-hover:scale-110 transition-transform"></i>
                        <span class="hidden lg:block font-mono text-sm">MY STORAGE</span>
                    </a>
                    <a href="#" class="flex items-center gap-4 p-3 rounded-xl hover:bg-white/5 text-gray-300 hover:text-cyber-purple transition-colors group">
                        <i class="ri-share-forward-line text-xl"></i>
                        <span class="hidden lg:block font-mono text-sm">SHARED</span>
                    </a>
                    <a href="#" class="flex items-center gap-4 p-3 rounded-xl hover:bg-white/5 text-gray-300 hover:text-yellow-400 transition-colors group">
                        <i class="ri-star-s-line text-xl"></i>
                        <span class="hidden lg:block font-mono text-sm">STARRED</span>
                    </a>
                </nav>

                <!-- Storage Info -->
                <div class="p-6 hidden lg:block border-t border-white/5">
                    <div class="flex justify-between text-xs font-mono mb-2 text-gray-400">
                        <span>STORAGE</span>
                        <span id="storage-text">Loading...</span>
                    </div>
                    <div class="w-full h-1.5 bg-gray-800 rounded-full overflow-hidden">
                        <div id="storage-bar" class="h-full bg-gradient-to-r from-cyber-neon to-cyber-purple w-0 transition-all duration-1000"></div>
                    </div>
                    
                    <div class="mt-6 flex items-center gap-3">
                        <div id="user-avatar" class="w-10 h-10 rounded-full bg-gray-700 overflow-hidden border border-white/20"></div>
                        <div class="overflow-hidden">
                            <div id="user-name" class="font-bold text-sm truncate">User</div>
                            <div class="text-xs text-gray-500 font-mono text-green-400">● ONLINE</div>
                        </div>
                        <button onclick="QuantumAuth.logout()" class="ml-auto text-red-500 hover:text-red-400"><i class="ri-logout-box-r-line"></i></button>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 relative flex flex-col h-full bg-black/20 backdrop-blur-sm">
                
                <!-- Topbar -->
                <header class="h-20 flex items-center justify-between px-8 border-b border-white/5">
                    <h2 class="text-2xl font-bold font-sans text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-500" id="folder-title">Root Directory</h2>
                    
                    <div class="flex items-center gap-4">
                        <div class="relative group">
                            <input type="text" placeholder="SEARCH DATABASE..." oninput="QuantumDrive.search(this.value)" class="bg-black/40 border border-white/10 rounded-full py-2 px-6 pl-10 w-64 text-sm font-mono focus:w-80 focus:border-cyber-neon focus:shadow-[0_0_15px_rgba(0,240,255,0.2)] transition-all outline-none">
                            <i class="ri-search-2-line absolute left-3 top-2.5 text-gray-500 group-focus-within:text-cyber-neon"></i>
                        </div>
                        <button onclick="QuantumUI.toggleView()" class="w-10 h-10 rounded-full border border-white/10 hover:bg-white/5 flex items-center justify-center transition-all hover:scale-110 active:scale-95">
                            <i id="view-icon" class="ri-grid-fill text-cyber-neon"></i>
                        </button>
                    </div>
                </header>

                <!-- Breadcrumbs -->
                <div class="px-8 py-4 text-xs font-mono text-gray-500 flex gap-2">
                    <span class="text-cyber-neon">ROOT</span> / <span class="text-white">FILES</span>
                </div>

                <!-- File Grid -->
                <div id="files-container" class="flex-1 overflow-y-auto p-8 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-6 content-start pb-24">
                    <!-- Files injected here -->
                </div>

                <!-- Floating Upload Button -->
                <div class="absolute bottom-8 right-8 z-50">
                    <button onclick="document.getElementById('file-input').click()" class="w-16 h-16 rounded-2xl bg-gradient-to-br from-cyber-neon to-cyber-purple shadow-[0_0_30px_rgba(0,240,255,0.4)] flex items-center justify-center text-black text-3xl hover:scale-110 hover:rotate-90 transition-all duration-300">
                        <i class="ri-add-line"></i>
                    </button>
                </div>

                <!-- Hidden Input -->
                <input type="file" id="file-input" hidden multiple onchange="QuantumUpload.handle(this.files)">
            </main>
        </section>

        <!-- NOTIFICATION TOAST (Holographic) -->
        <div id="toast-container" class="fixed top-8 left-1/2 -translate-x-1/2 z-[100] pointer-events-none"></div>

    </div>

    <!-- ======================= LOGIC ======================= -->
    <script>
        // --- 1. CONFIGURATION ---
        const CONFIG = {
            clientId: '318681315152-65e9kofptt4c3bk3kmlj9gmksnasu347.apps.googleusercontent.com', // Demo ID
            scopes: 'https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/userinfo.profile',
            pin: '1234'
        };

        const STATE = {
            token: localStorage.getItem('q_token'),
            files: [],
            view: 'grid'
        };

        // --- 2. THREE.JS BACKGROUND (The Neural Network) ---
        function initBackground() {
            const canvas = document.getElementById('neural-canvas');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
            
            renderer.setSize(window.innerWidth, window.innerHeight);
            camera.position.z = 30;

            // Particles
            const geometry = new THREE.IcosahedronGeometry(15, 1);
            const material = new THREE.MeshBasicMaterial({ color: 0x00F0FF, wireframe: true, transparent: true, opacity: 0.1 });
            const sphere = new THREE.Mesh(geometry, material);
            scene.add(sphere);

            // Floating Nodes
            const particlesGeo = new THREE.BufferGeometry();
            const count = 300;
            const posArray = new Float32Array(count * 3);
            for(let i=0; i<count*3; i++) {
                posArray[i] = (Math.random() - 0.5) * 60;
            }
            particlesGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            const particlesMat = new THREE.PointsMaterial({
                size: 0.15,
                color: 0xBD00FF,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending
            });
            const particlesMesh = new THREE.Points(particlesGeo, particlesMat);
            scene.add(particlesMesh);

            // Animation Loop
            let mouseX = 0;
            let mouseY = 0;
            
            window.addEventListener('mousemove', (e) => {
                mouseX = e.clientX / window.innerWidth - 0.5;
                mouseY = e.clientY / window.innerHeight - 0.5;
            });

            function animate() {
                requestAnimationFrame(animate);
                
                sphere.rotation.y += 0.002;
                particlesMesh.rotation.y = -mouseX * 0.5;
                particlesMesh.rotation.x = -mouseY * 0.5;
                
                // Gentle float
                const time = Date.now() * 0.0005;
                sphere.position.y = Math.sin(time) * 2;

                renderer.render(scene, camera);
            }
            animate();

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        // --- 3. UI ANIMATION ENGINE (GSAP) ---
        const FX = {
            scrambleText: (element, text, speed = 50) => {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*';
                let iterations = 0;
                const interval = setInterval(() => {
                    element.innerText = text
                        .split('')
                        .map((letter, index) => {
                            if(index < iterations) return text[index];
                            return chars[Math.floor(Math.random() * chars.length)];
                        })
                        .join('');
                    if(iterations >= text.length) clearInterval(interval);
                    iterations += 1/3;
                }, speed);
            },
            showScreen: (id) => {
                document.querySelectorAll('section').forEach(s => {
                    if(!s.classList.contains('hidden')) {
                        gsap.to(s, { opacity: 0, scale: 0.95, duration: 0.5, onComplete: () => s.classList.add('hidden') });
                    }
                });
                const el = document.getElementById(id);
                el.classList.remove('hidden');
                gsap.fromTo(el, { opacity: 0, scale: 1.1 }, { opacity: 1, scale: 1, duration: 0.8, ease: "power4.out" });
            },
            toast: (msg, type = 'info') => {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');
                const color = type === 'error' ? 'border-red-500 text-red-500' : 'border-cyber-neon text-cyber-neon';
                
                toast.className = `bg-black/80 backdrop-blur-md border ${color} px-6 py-3 rounded-full mb-3 shadow-[0_0_20px_rgba(0,0,0,0.5)] flex items-center gap-3 transform translate-y-[-20px] opacity-0`;
                toast.innerHTML = `<i class="ri-notification-3-line"></i> <span class="font-mono text-sm">${msg}</span>`;
                
                container.appendChild(toast);
                gsap.to(toast, { y: 0, opacity: 1, duration: 0.3 });
                setTimeout(() => {
                    gsap.to(toast, { y: -20, opacity: 0, onComplete: () => toast.remove() });
                }, 3000);
            }
        };

        // --- 4. AUTHENTICATION & BOOT ---
        const QuantumAuth = {
            client: null,
            init() {
                // Generate Keypad
                const keypadContainer = document.querySelector('#lock-screen .grid');
                [1,2,3,4,5,6,7,8,9,'C',0,'OK'].forEach(key => {
                    const btn = document.createElement('div');
                    btn.className = 'h-14 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/20 active:scale-95 transition-all cursor-pointer select-none';
                    btn.innerText = key;
                    btn.onclick = () => this.handleKey(key);
                    keypadContainer.appendChild(btn);
                });

                if(window.google) {
                    this.client = google.accounts.oauth2.initTokenClient({
                        client_id: CONFIG.clientId,
                        scope: CONFIG.scopes,
                        callback: (resp) => {
                            if(resp.access_token) {
                                STATE.token = resp.access_token;
                                localStorage.setItem('q_token', STATE.token);
                                this.fetchProfile();
                                FX.showScreen('app-screen');
                                QuantumDrive.loadFiles();
                            }
                        }
                    });
                }
            },
            pinBuffer: '',
            handleKey(key) {
                if(key === 'C') { this.pinBuffer = ''; this.updateDots(); return; }
                if(key === 'OK') { this.checkPin(); return; }
                if(this.pinBuffer.length < 4) {
                    this.pinBuffer += key;
                    this.updateDots();
                    if(this.pinBuffer.length === 4) setTimeout(() => this.checkPin(), 300);
                }
            },
            updateDots() {
                for(let i=1; i<=4; i++) {
                    const dot = document.getElementById(`dot-${i}`);
                    if(i <= this.pinBuffer.length) {
                        dot.className = 'w-4 h-4 rounded-full bg-cyber-neon shadow-[0_0_10px_#00F0FF] border-none transition-all duration-300';
                    } else {
                        dot.className = 'w-4 h-4 rounded-full border border-cyber-neon transition-all duration-300';
                    }
                }
            },
            checkPin() {
                if(this.pinBuffer === CONFIG.pin) {
                    FX.toast('ACCESS GRANTED', 'success');
                    if(STATE.token) {
                        FX.showScreen('app-screen');
                        QuantumDrive.loadFiles();
                        this.fetchProfile();
                    } else {
                        FX.showScreen('auth-screen');
                    }
                } else {
                    FX.toast('INVALID CREDENTIALS', 'error');
                    this.pinBuffer = '';
                    this.updateDots();
                    gsap.to('#lock-screen .holo-card', { x: 10, duration: 0.1, yoyo: true, repeat: 5 });
                }
            },
            googleSignIn() {
                this.client.requestAccessToken();
            },
            async fetchProfile() {
                try {
                    const res = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
                        headers: {'Authorization': `Bearer ${STATE.token}`}
                    });
                    const data = await res.json();
                    document.getElementById('user-name').innerText = data.name;
                    document.getElementById('user-avatar').innerHTML = `<img src="${data.picture}" class="w-full h-full object-cover">`;
                } catch(e) { console.error(e); }
            },
            logout() {
                localStorage.removeItem('q_token');
                location.reload();
            }
        };

        // --- 5. DRIVE OS LOGIC ---
        const QuantumDrive = {
            async loadFiles(folderId = 'root') {
                const container = document.getElementById('files-container');
                container.innerHTML = `<div class="col-span-full text-center text-cyber-neon animate-pulse mt-20 font-mono">ESTABLISHING UPLINK...</div>`;
                
                if(!STATE.token) return;

                try {
                    const q = `'${folderId}' in parents and trashed = false`;
                    const res = await fetch(`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(q)}&fields=files(id,name,mimeType,thumbnailLink,iconLink)&pageSize=30`, {
                        headers: { 'Authorization': `Bearer ${STATE.token}` }
                    });
                    const data = await res.json();
                    
                    container.innerHTML = '';
                    if(!data.files || data.files.length === 0) {
                        container.innerHTML = `<div class="col-span-full text-center text-gray-500 font-mono">SECTOR EMPTY</div>`;
                        return;
                    }

                    // Render with Stagger Animation
                    data.files.forEach((file, index) => {
                        const isFolder = file.mimeType === 'application/vnd.google-apps.folder';
                        const iconClass = isFolder ? 'ri-folder-3-fill text-yellow-400' : 
                                         file.mimeType.includes('image') ? 'ri-image-fill text-purple-400' : 'ri-file-text-fill text-blue-400';
                        
                        const el = document.createElement('div');
                        el.className = 'holo-card p-4 rounded-xl flex flex-col items-center justify-center cursor-pointer group h-32 opacity-0 transform translate-y-4 relative overflow-hidden';
                        el.innerHTML = `
                            <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                            <i class="${iconClass} text-4xl mb-2 z-10 group-hover:scale-110 transition-transform duration-300 drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]"></i>
                            <span class="text-xs font-mono text-center truncate w-full z-10 group-hover:text-cyber-neon transition-colors">${file.name}</span>
                        `;
                        el.onclick = () => isFolder ? this.loadFiles(file.id) : window.open(file.webViewLink);
                        
                        // Tilt Effect Logic
                        el.onmousemove = (e) => {
                            const rect = el.getBoundingClientRect();
                            const x = e.clientX - rect.left;
                            const y = e.clientY - rect.top;
                            el.style.transform = `perspective(1000px) rotateX(${(y - rect.height/2) / 10}deg) rotateY(${-(x - rect.width/2) / 10}deg) scale(1.05)`;
                        };
                        el.onmouseleave = () => {
                            el.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
                        };

                        container.appendChild(el);
                    });

                    // GSAP Stagger Entry
                    gsap.to('#files-container .holo-card', {
                        opacity: 1,
                        y: 0,
                        duration: 0.5,
                        stagger: 0.05,
                        ease: "back.out(1.7)"
                    });

                } catch(e) {
                    FX.toast('CONNECTION SEVERED', 'error');
                }
            },
            search(query) {
               // Basic implementation for visual feedback
               const items = document.querySelectorAll('#files-container .holo-card');
               items.forEach(item => {
                   const text = item.innerText.toLowerCase();
                   item.style.display = text.includes(query.toLowerCase()) ? 'flex' : 'none';
               });
            }
        };

        const QuantumUI = {
            toggleView() {
                const container = document.getElementById('files-container');
                STATE.view = STATE.view === 'grid' ? 'list' : 'grid';
                if(STATE.view === 'list') {
                    container.classList.remove('grid-cols-2', 'md:grid-cols-4');
                    container.classList.add('flex', 'flex-col');
                    document.getElementById('view-icon').className = 'ri-list-check text-cyber-neon';
                } else {
                    container.classList.add('grid-cols-2', 'md:grid-cols-4');
                    container.classList.remove('flex', 'flex-col');
                    document.getElementById('view-icon').className = 'ri-grid-fill text-cyber-neon';
                }
            }
        };

        // --- 6. BOOT SEQUENCE ---
        window.onload = () => {
            initBackground();
            
            // Boot Animation
            const tl = gsap.timeline();
            
            tl.to('#boot-bar', { width: '100%', duration: 2, ease: "power2.inOut" })
              .to('#boot-log', { text: "Loading Quantum modules...", duration: 0.5 })
              .to('#boot-log', { text: "Establishing secure handshake...", duration: 0.5 })
              .to('#boot-log', { text: "System Ready.", duration: 0.5 })
              .to('#boot-screen', { opacity: 0, duration: 0.5, onComplete: () => {
                  document.getElementById('boot-screen').classList.add('hidden');
                  FX.showScreen('lock-screen');
                  QuantumAuth.init();
              }});
        };

    </script>
</body>
</html>
