<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>DREAM VAULT OS | Pro</title>
    
    <!-- Libraries -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf_viewer.min.css">

    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #34a853;
            --danger: #ea4335;
            --warning: #fbbc04;
            --surface: #ffffff;
            --bg: #f8f9fa;
            --bg-dark: #202124;
            --text-main: #202124;
            --text-sec: #5f6368;
            --text-light: #ffffff;
            --border: #dadce0;
            --hover: #f1f3f4;
            --hover-dark: #3c4043;
            --shadow: 0 1px 2px 0 rgba(60,64,67,0.3), 0 1px 3px 1px rgba(60,64,67,0.15);
            --shadow-lg: 0 4px 12px rgba(0,0,0,0.15);
            --radius: 12px;
            --radius-lg: 20px;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --primary: #8ab4f8;
                --surface: #202124;
                --bg: #171717;
                --text-main: #e8eaed;
                --text-sec: #9aa0a6;
                --border: #3c4043;
                --hover: #2d2e30;
            }
        }

        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            outline: none; 
            user-select: none;
            -webkit-user-drag: none;
        }
        
        body {
            margin: 0; padding: 0;
            font-family: 'Roboto', sans-serif;
            background: var(--bg); color: var(--text-main);
            height: 100vh; height: 100dvh;
            display: flex; flex-direction: column; 
            overflow: hidden;
            padding-top: var(--safe-top);
            padding-bottom: var(--safe-bottom);
            transition: background 0.3s, color 0.3s;
        }

        /* --- LOCK SCREEN ENHANCED --- */
        #lock-screen {
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--primary-dark) 100%);
            color: var(--text-light);
        }
        .lock-header {
            position: absolute; top: 60px; left: 0; width: 100%;
            text-align: center; font-family: 'Google Sans'; font-size: 28px;
            font-weight: 500; opacity: 0.9;
        }
        .pin-container {
            text-align: center; width: 100%; max-width: 320px;
            padding: 20px;
        }
        .pin-dots {
            display: flex; justify-content: center; gap: 20px; 
            margin: 40px 0;
        }
        .dot {
            width: 18px; height: 18px; border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3); 
            background: rgba(255,255,255,0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .dot.filled {
            background: var(--text-light); border-color: var(--text-light);
            transform: scale(1.2);
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
        }
        .keypad {
            display: grid; grid-template-columns: repeat(3, 1fr); 
            gap: 15px; padding: 0 15px;
        }
        .key {
            width: 75px; height: 75px; border-radius: 50%;
            background: rgba(255,255,255,0.1); color: var(--text-light);
            font-size: 26px; display: flex; align-items: center; 
            justify-content: center; margin: auto; cursor: pointer;
            transition: all 0.2s; font-weight: 300;
            backdrop-filter: blur(10px);
        }
        .key:active {
            background: rgba(255,255,255,0.2);
            transform: scale(0.95);
        }
        .key.clear { 
            background: transparent; font-size: 14px; 
            opacity: 0.7; font-weight: 400;
        }
        .lock-footer {
            position: absolute; bottom: 40px; width: 100%;
            text-align: center; font-size: 14px; opacity: 0.6;
        }

        /* --- SECURITY BADGE --- */
        .security-badge {
            position: fixed; top: 15px; right: 15px;
            background: rgba(234, 67, 53, 0.1); color: var(--danger);
            padding: 6px 12px; border-radius: 20px; font-size: 12px;
            display: flex; align-items: center; gap: 6px; z-index: 3000;
            backdrop-filter: blur(10px); border: 1px solid rgba(234, 67, 53, 0.2);
        }

        /* --- APP HEADER ENHANCED --- */
        .app-header {
            background: var(--surface); padding: 12px 16px;
            height: 64px; display: flex; align-items: center; 
            justify-content: space-between; box-shadow: 0 1px 0 var(--border);
            position: sticky; top: 0; z-index: 100;
            padding-top: calc(12px + var(--safe-top));
        }
        .header-left, .header-right {
            display: flex; align-items: center; gap: 16px;
        }
        .network-status {
            display: flex; align-items: center; gap: 6px;
            font-size: 12px; color: var(--text-sec);
        }
        .network-dot {
            width: 8px; height: 8px; border-radius: 50%;
            background: var(--secondary);
        }
        .network-dot.offline { background: var(--danger); }
        .network-dot.slow { background: var(--warning); }

        /* --- VIRTUAL SCROLLING --- */
        .virtual-scroll {
            flex: 1; overflow-y: auto; overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            contain: content;
        }
        .virtual-content {
            position: relative; height: var(--total-height, 1000px);
        }
        .file-item {
            position: absolute; width: 100%;
            will-change: transform;
        }

        /* --- GESTURE NAVIGATION --- */
        .swipe-area {
            position: fixed; left: 0; width: 30px; height: 100%;
            top: 0; z-index: 1;
        }
        .gesture-indicator {
            position: fixed; left: 0; top: 50%; transform: translateY(-50%);
            width: 4px; height: 60px; background: var(--primary);
            border-radius: 0 4px 4px 0; opacity: 0; transition: opacity 0.3s;
        }

        /* --- ZIP VIEWER --- */
        .zip-viewer {
            background: var(--surface); padding: 20px;
            border-radius: var(--radius); margin: 10px;
            max-height: 70vh; overflow-y: auto;
        }
        .zip-header {
            display: flex; justify-content: space-between;
            align-items: center; margin-bottom: 20px;
        }
        .zip-item {
            display: flex; align-items: center; padding: 12px;
            border-bottom: 1px solid var(--border); cursor: pointer;
        }
        .zip-item:hover { background: var(--hover); }
        .zip-icon { margin-right: 12px; color: var(--text-sec); }

        /* --- ADMIN PANEL --- */
        .admin-panel {
            background: var(--surface); border-radius: var(--radius);
            padding: 20px; margin: 10px; display: none;
        }
        .admin-log {
            background: var(--bg); padding: 15px; border-radius: var(--radius);
            max-height: 300px; overflow-y: auto; font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            padding: 8px; border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between;
        }
        .log-time { color: var(--text-sec); font-size: 11px; }

        /* --- OFFLINE INDICATOR --- */
        .offline-banner {
            position: fixed; top: 0; left: 0; width: 100%;
            background: var(--warning); color: #000; text-align: center;
            padding: 10px; font-size: 14px; z-index: 3000;
            display: none;
        }

        /* --- LOADING SKELETON --- */
        .skeleton {
            background: linear-gradient(90deg, var(--hover) 25%, var(--border) 50%, var(--hover) 75%);
            background-size: 200% 100%; animation: loading 1.5s infinite;
            border-radius: 4px;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* --- CONTEXT MENU ANIMATION --- */
        .ctx-item {
            transform: translateX(-20px); opacity: 0;
            animation: slideIn 0.2s forwards;
        }
        @keyframes slideIn {
            to { transform: translateX(0); opacity: 1; }
        }

        /* --- RESPONSIVE ADJUSTMENTS --- */
        @media (max-width: 480px) {
            .key { width: 70px; height: 70px; font-size: 24px; }
            .pin-dots { gap: 15px; }
            .dot { width: 16px; height: 16px; }
        }

        @media (min-width: 768px) {
            .file-grid-view { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
        }

        /* --- ORIENTATION HANDLING --- */
        @media (orientation: landscape) {
            .lock-header { top: 30px; }
            .keypad { max-width: 280px; margin: 0 auto; }
        }

        /* --- DARK MODE IMPROVEMENTS --- */
        @media (prefers-color-scheme: dark) {
            .key { background: rgba(255,255,255,0.05); }
            .pin-dots .dot { border-color: rgba(255,255,255,0.2); }
        }
    </style>
</head>
<body>
    <!-- SECURITY OVERLAY -->
    <div class="security-badge" id="security-badge">
        <span class="material-icons-round" style="font-size:14px">lock</span>
        <span>Secure Session</span>
    </div>

    <!-- OFFLINE BANNER -->
    <div class="offline-banner" id="offline-banner">
        <span class="material-icons-round" style="vertical-align:middle; font-size:16px">wifi_off</span>
        You're offline. Some features may be limited.
    </div>

    <!-- [SCREEN 1] ENHANCED LOCK SCREEN -->
    <div id="lock-screen" class="screen active">
        <div class="lock-header">DREAM VAULT</div>
        <div class="pin-container">
            <div class="pin-dots" id="pin-dots">
                <div class="dot"></div><div class="dot"></div>
                <div class="dot"></div><div class="dot"></div>
            </div>
            <div class="keypad">
                <div class="key" onclick="Keypad.press(1)">1</div>
                <div class="key" onclick="Keypad.press(2)">2</div>
                <div class="key" onclick="Keypad.press(3)">3</div>
                <div class="key" onclick="Keypad.press(4)">4</div>
                <div class="key" onclick="Keypad.press(5)">5</div>
                <div class="key" onclick="Keypad.press(6)">6</div>
                <div class="key" onclick="Keypad.press(7)">7</div>
                <div class="key" onclick="Keypad.press(8)">8</div>
                <div class="key" onclick="Keypad.press(9)">9</div>
                <div class="key clear" onclick="Keypad.reset()">CLEAR</div>
                <div class="key" onclick="Keypad.press(0)">0</div>
                <div class="key clear" onclick="Keypad.backspace()">
                    <span class="material-icons-round">backspace</span>
                </div>
            </div>
        </div>
        <div class="lock-footer" id="lock-timer">Enter PIN to unlock</div>
    </div>

    <!-- [SCREEN 2] AUTH (UNCHANGED) -->
    <div id="auth-screen" class="screen">...</div>

    <!-- [SCREEN 3] ENHANCED APP SCREEN -->
    <div id="app-screen" class="screen">
        <div class="app-header">
            <div class="header-left">
                <span class="material-icons-round" onclick="Nav.toggleMenu()">menu</span>
                <div class="network-status" id="network-status">
                    <div class="network-dot" id="network-dot"></div>
                    <span id="network-text">Online</span>
                </div>
            </div>
            <div class="search-bar">
                <span class="material-icons-round">search</span>
                <input type="text" class="search-input" placeholder="Search Drive" 
                       id="search-input" onkeyup="Drive.search(this.value)">
            </div>
            <div class="header-right">
                <span class="material-icons-round" onclick="Drive.refresh()" 
                      style="padding:8px">refresh</span>
                <img id="user-avatar" src="" 
                     style="width:36px;height:36px;border-radius:50%;cursor:pointer" 
                     onclick="Settings.open()">
            </div>
        </div>

        <!-- GESTURE AREA -->
        <div class="swipe-area" id="swipe-area"></div>
        <div class="gesture-indicator" id="gesture-indicator"></div>

        <!-- TOOLBAR -->
        <div class="toolbar">
            <div class="breadcrumb" id="breadcrumb" onclick="Drive.goBack()">
                <span class="material-icons-round" style="font-size:20px">chevron_left</span>
                My Drive
            </div>
            <div style="display:flex;gap:15px;">
                <span class="material-icons-round" id="view-toggle" onclick="UI.toggleView()">grid_view</span>
                <span class="material-icons-round" onclick="Drive.sortMenu()">sort</span>
                <span class="material-icons-round" onclick="Admin.togglePanel()">admin_panel_settings</span>
            </div>
        </div>

        <!-- ADMIN PANEL -->
        <div class="admin-panel" id="admin-panel">
            <h3 style="margin-top:0">Admin Dashboard</h3>
            <div class="admin-log" id="admin-log">
                <!-- Log entries will appear here -->
            </div>
            <button onclick="Admin.clearLogs()" style="margin-top:10px;width:100%">
                Clear Logs
            </button>
        </div>

        <!-- VIRTUAL SCROLLING CONTAINER -->
        <div class="virtual-scroll" id="file-container">
            <div class="virtual-content" id="virtual-content"></div>
        </div>

        <!-- FAB & BOTTOM NAV (UNCHANGED) -->
        <div class="fab-container">...</div>
        <div class="bottom-nav">...</div>
    </div>

    <!-- [MODALS] -->

    <!-- ZIP VIEWER MODAL -->
    <div id="zip-modal" class="modal-mask" onclick="if(event.target===this) UI.closeModal('zip-modal')">
        <div class="modal-sheet" style="max-height:90vh">
            <div class="sheet-head">
                <span class="sheet-title" id="zip-title">ZIP Archive</span>
                <span class="material-icons-round" onclick="UI.closeModal('zip-modal')">close</span>
            </div>
            <div class="zip-viewer" id="zip-contents">
                <!-- ZIP contents will be loaded here -->
            </div>
        </div>
    </div>

    <!-- ENHANCED MEDIA VIEWER -->
    <div id="media-view" class="media-viewer">
        <div class="media-header">
            <span id="media-title">Preview</span>
            <div style="display:flex;gap:15px;">
                <span class="material-icons-round" onclick="Ops.download()">download</span>
                <span class="material-icons-round" onclick="Ops.openExternal()">open_in_new</span>
                <span class="material-icons-round" onclick="UI.closeMedia()">close</span>
            </div>
        </div>
        <div id="media-content">
            <!-- Dynamic content based on file type -->
            <div id="pdf-viewer" style="display:none;width:100%;height:100%"></div>
            <video id="video-player" style="display:none;width:100%;height:100%"></video>
            <audio id="audio-player" style="display:none;width:100%"></audio>
            <div id="text-viewer" style="display:none;padding:20px;overflow:auto"></div>
            <div id="code-viewer" style="display:none;padding:20px;overflow:auto"></div>
            <div id="markdown-viewer" style="display:none;padding:20px;overflow:auto"></div>
        </div>
    </div>

    <script>
        // ===================== CONFIGURATION =====================
        const CONFIG = {
            clientId: '318681315152-65e9kofptt4c3bk3kmlj9gmksnasu347.apps.googleusercontent.com',
            scopes: 'https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/userinfo.email',
            vaultId: '1zIyinAqjQv96QBSuanFS2F0USaG66GPn',
            adminEmails: ['admin@example.com', 'your-email@gmail.com'],
            chunkSize: 5 * 1024 * 1024, // 5MB chunks for upload
            maxRetries: 3,
            cooldownTime: 30000, // 30 seconds cooldown
            autoLockTime: 5 * 60 * 1000, // 5 minutes
            virtualScrollItemHeight: 60,
            offlineCacheSize: 50 // Max files to cache offline
        };

        // ===================== STATE MANAGEMENT =====================
        const STATE = {
            token: localStorage.getItem('g_token'),
            currFolder: 'root',
            folderStack: [],
            files: [],
            fileCache: new Map(),
            selected: null,
            viewMode: localStorage.getItem('view_mode') || 'list',
            settings: JSON.parse(localStorage.getItem('d_settings') || '{"extPlayer":false,"darkMode":false}'),
            session: {
                start: Date.now(),
                lastActivity: Date.now(),
                failedAttempts: parseInt(localStorage.getItem('failed_attempts') || '0'),
                isAdmin: false,
                offline: !navigator.onLine
            },
            uploadQueue: JSON.parse(localStorage.getItem('upload_queue') || '[]'),
            network: {
                online: navigator.onLine,
                speed: 'unknown',
                quotaUsed: 0
            },
            virtualScroll: {
                start: 0,
                end: 20,
                totalHeight: 0
            }
        };

        // ===================== SECURITY SYSTEM =====================
        const Security = {
            attempts: 0,
            lockedUntil: 0,
            inactivityTimer: null,
            sessionTimer: null,

            init: () => {
                Security.checkCooldown();
                Security.startInactivityTimer();
                Security.startSessionTimer();
                window.addEventListener('online', Security.onNetworkChange);
                window.addEventListener('offline', Security.onNetworkChange);
            },

            hashPIN: (pin) => {
                // Simple base64 hash for demo - in production use SHA-256
                return btoa(pin.split('').reverse().join('') + 'SALT');
            },

            checkCooldown: () => {
                const locked = localStorage.getItem('locked_until');
                if (locked && Date.now() < parseInt(locked)) {
                    const remaining = Math.ceil((parseInt(locked) - Date.now()) / 1000);
                    alert(`Too many attempts. Try again in ${remaining}s`);
                    return true;
                }
                return false;
            },

            failedAttempt: () => {
                Security.attempts++;
                localStorage.setItem('failed_attempts', Security.attempts);
                
                if (Security.attempts >= 5) {
                    Security.lockedUntil = Date.now() + CONFIG.cooldownTime;
                    localStorage.setItem('locked_until', Security.lockedUntil.toString());
                    alert('Too many failed attempts. Locked for 30 seconds.');
                }
            },

            resetAttempts: () => {
                Security.attempts = 0;
                localStorage.removeItem('failed_attempts');
                localStorage.removeItem('locked_until');
            },

            startInactivityTimer: () => {
                const resetTimer = () => {
                    STATE.session.lastActivity = Date.now();
                    clearTimeout(Security.inactivityTimer);
                    Security.inactivityTimer = setTimeout(() => {
                        if (STATE.token) {
                            alert('Session timeout due to inactivity');
                            Auth.logout();
                        }
                    }, CONFIG.autoLockTime);
                };

                ['mousedown', 'keydown', 'touchstart', 'scroll'].forEach(evt => {
                    document.addEventListener(evt, resetTimer);
                });
                resetTimer();
            },

            startSessionTimer: () => {
                clearInterval(Security.sessionTimer);
                Security.sessionTimer = setInterval(() => {
                    const exp = localStorage.getItem('g_exp');
                    if (exp && Date.now() > parseInt(exp)) {
                        Auth.logout();
                    }
                }, 60000); // Check every minute
            },

            onNetworkChange: () => {
                STATE.session.offline = !navigator.onLine;
                document.getElementById('offline-banner').style.display = 
                    STATE.session.offline ? 'block' : 'none';
                
                if (navigator.onLine && STATE.uploadQueue.length > 0) {
                    Upload.processQueue();
                }
            },

            logActivity: (action, details) => {
                if (!STATE.session.isAdmin) return;
                
                const log = {
                    time: new Date().toISOString(),
                    action,
                    details,
                    user: STATE.session.email
                };
                
                const logs = JSON.parse(localStorage.getItem('admin_logs') || '[]');
                logs.unshift(log);
                if (logs.length > 100) logs.pop();
                localStorage.setItem('admin_logs', JSON.stringify(logs));
                
                Admin.updateLogDisplay();
            }
        };

        // ===================== ENHANCED KEYPAD =====================
        const Keypad = {
            input: "",
            press: (num) => {
                if (Keypad.input.length < 4) {
                    Keypad.input += num;
                    Keypad.updateDots();
                    if (Keypad.input.length === 4) {
                        setTimeout(Keypad.check, 300);
                    }
                }
            },
            backspace: () => {
                if (Keypad.input.length > 0) {
                    Keypad.input = Keypad.input.slice(0, -1);
                    Keypad.updateDots();
                }
            },
            updateDots: () => {
                const dots = document.querySelectorAll('.dot');
                dots.forEach((d, i) => {
                    d.classList.toggle('filled', i < Keypad.input.length);
                });
            },
            reset: () => {
                Keypad.input = "";
                Keypad.updateDots();
            },
            check: async () => {
                if (Security.checkCooldown()) {
                    Keypad.reset();
                    return;
                }

                const stored = localStorage.getItem('app_pin');
                const hash = Security.hashPIN(Keypad.input);

                if (!stored) {
                    localStorage.setItem('app_pin', hash);
                    Security.resetAttempts();
                    Auth.check();
                } else {
                    if (stored === hash) {
                        Security.resetAttempts();
                        Auth.check();
                    } else {
                        Security.failedAttempt();
                        Keypad.reset();
                        // Shake animation
                        document.querySelector('.pin-container').style.animation = 'shake 0.5s';
                        setTimeout(() => {
                            document.querySelector('.pin-container').style.animation = '';
                        }, 500);
                    }
                }
            }
        };

        // ===================== AUTH WITH ADMIN DETECTION =====================
        const Auth = {
            init: () => {
                tokenClient = google.accounts.oauth2.initTokenClient({
                    client_id: CONFIG.clientId,
                    scope: CONFIG.scopes,
                    callback: (r) => {
                        if (r.error) {
                            Security.logActivity('AUTH_FAILED', { error: r.error });
                            return alert("Login Failed");
                        }
                        STATE.token = r.access_token;
                        localStorage.setItem('g_token', STATE.token);
                        localStorage.setItem('g_exp', Date.now() + 3500 * 1000);
                        Security.logActivity('LOGIN_SUCCESS', {});
                        UI.switchScreen('app-screen');
                        Drive.load('root');
                        Auth.loadProfile();
                    }
                });
            },
            check: () => {
                const exp = localStorage.getItem('g_exp');
                if (STATE.token && exp && Date.now() < parseInt(exp)) {
                    UI.switchScreen('app-screen');
                    Drive.load('root');
                    Auth.loadProfile();
                } else {
                    UI.switchScreen('auth-screen');
                }
            },
            loadProfile: () => {
                fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
                    headers: { 'Authorization': `Bearer ${STATE.token}` }
                })
                .then(r => r.json())
                .then(d => {
                    document.getElementById('user-avatar').src = d.picture;
                    STATE.session.email = d.email;
                    STATE.session.isAdmin = CONFIG.adminEmails.includes(d.email);
                    
                    if (STATE.session.isAdmin) {
                        Security.logActivity('ADMIN_LOGIN', { email: d.email });
                    }
                });
            },
            logout: () => {
                Security.logActivity('LOGOUT', {});
                google.accounts.oauth2.revoke(STATE.token, () => {
                    localStorage.clear();
                    location.reload();
                });
            }
        };

        // ===================== VIRTUAL SCROLLING DRIVE ENGINE =====================
        const Drive = {
            load: async (id) => {
                STATE.currFolder = id;
                Drive.updateBreadcrumb();
                history.pushState({ folderId: id }, null, "");
                
                // Show skeleton loading
                Drive.renderSkeleton();
                
                try {
                    const q = `'${id}' in parents and trashed = false`;
                    const fields = "files(id,name,mimeType,size,iconLink,thumbnailLink,webViewLink,webContentLink,modifiedTime,starred)";
                    const url = `https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(q)}&fields=${encodeURIComponent(fields)}&orderBy=folder,name&pageSize=1000`;
                    
                    const res = await fetch(url, {
                        headers: { 'Authorization': `Bearer ${STATE.token}` }
                    });
                    const data = await res.json();
                    
                    STATE.files = data.files || [];
                    STATE.fileCache.set(id, STATE.files);
                    
                    // Calculate virtual scroll height
                    STATE.virtualScroll.totalHeight = STATE.files.length * CONFIG.virtualScrollItemHeight;
                    document.getElementById('virtual-content').style.height = 
                        `${STATE.virtualScroll.totalHeight}px`;
                    
                    Drive.renderVisibleItems();
                    
                } catch (e) {
                    console.error('Load error:', e);
                    // Try cache if offline
                    if (STATE.session.offline && STATE.fileCache.has(id)) {
                        STATE.files = STATE.fileCache.get(id);
                        Drive.renderVisibleItems();
                    }
                }
            },
            
            renderSkeleton: () => {
                const container = document.getElementById('virtual-content');
                container.innerHTML = '';
                
                for (let i = 0; i < 10; i++) {
                    const el = document.createElement('div');
                    el.className = 'file-item list-item skeleton';
                    el.style.height = `${CONFIG.virtualScrollItemHeight}px`;
                    el.style.top = `${i * CONFIG.virtualScrollItemHeight}px`;
                    container.appendChild(el);
                }
            },
            
            renderVisibleItems: () => {
                const container = document.getElementById('virtual-content');
                const scrollTop = container.parentElement.scrollTop;
                
                STATE.virtualScroll.start = Math.floor(scrollTop / CONFIG.virtualScrollItemHeight);
                STATE.virtualScroll.end = Math.min(
                    STATE.virtualScroll.start + 30,
                    STATE.files.length
                );
                
                // Clear only non-visible items
                const items = container.querySelectorAll('.file-item:not(.skeleton)');
                items.forEach(item => {
                    const idx = parseInt(item.dataset.index);
                    if (idx < STATE.virtualScroll.start || idx >= STATE.virtualScroll.end) {
                        item.remove();
                    }
                });
                
                // Render visible items
                for (let i = STATE.virtualScroll.start; i < STATE.virtualScroll.end; i++) {
                    const file = STATE.files[i];
                    if (!document.querySelector(`[data-index="${i}"]`)) {
                        const el = Drive.createFileElement(file, i);
                        container.appendChild(el);
                    }
                }
            },
            
            createFileElement: (f, index) => {
                const isDir = f.mimeType === 'application/vnd.google-apps.folder';
                const el = document.createElement('div');
                el.className = `file-item ${STATE.viewMode === 'list' ? 'list-item' : 'grid-item'}`;
                el.style.height = `${CONFIG.virtualScrollItemHeight}px`;
                el.style.top = `${index * CONFIG.virtualScrollItemHeight}px`;
                el.dataset.index = index;
                
                let icon = isDir ? 'folder' : 'insert_drive_file';
                if (f.mimeType.includes('image')) icon = 'image';
                else if (f.mimeType.includes('video')) icon = 'movie';
                else if (f.mimeType.includes('audio')) icon = 'audiotrack';
                else if (f.mimeType.includes('pdf')) icon = 'picture_as_pdf';
                else if (f.mimeType.includes('zip')) icon = 'archive';
                else if (f.mimeType.includes('text')) icon = 'description';
                
                el.innerHTML = `
                    <span class="material-icons-round item-icon ${isDir?'folder-icon':''}">${icon}</span>
                    <div class="item-text">
                        <span class="item-name">${f.name}</span>
                        <span class="item-meta">${isDir ? 'Folder' : Ops.fmtSize(f.size)} â€¢ ${new Date(f.modifiedTime).toLocaleDateString()}</span>
                    </div>
                    ${f.starred ? '<span class="material-icons-round" style="color:#fbbc04">star</span>' : ''}
                    <span class="material-icons-round" style="color:var(--text-sec); padding:10px;" 
                          onclick="event.stopPropagation(); Ops.menu('${f.id}')">more_vert</span>
                `;
                
                el.onclick = () => isDir ? Drive.load(f.id) : Ops.preview();
                return el;
            },
            
            updateBreadcrumb: () => {
                const b = document.getElementById('breadcrumb');
                if (STATE.currFolder === 'root') b.innerHTML = '<span class="material-icons-round" style="font-size:20px">chevron_left</span> My Drive';
                else if (STATE.currFolder === CONFIG.vaultId) b.innerHTML = '<span class="material-icons-round" style="font-size:20px">chevron_left</span> Vault';
                else b.innerHTML = '<span class="material-icons-round" style="font-size:20px">chevron_left</span> ... / Folder';
            },
            
            refresh: () => {
                Drive.load(STATE.currFolder);
            },
            
            search: (query) => {
                if (!query.trim()) {
                    Drive.renderVisibleItems();
                    return;
                }
                
                const filtered = STATE.files.filter(f => 
                    f.name.toLowerCase().includes(query.toLowerCase())
                );
                
                // Temporarily replace files for search
                const original = STATE.files;
                STATE.files = filtered;
                Drive.renderVisibleItems();
                STATE.files = original;
            },
            
            sortMenu: () => {
                UI.showActionSheet([
                    { text: 'Name A-Z', icon: 'sort_by_alpha', action: () => Drive.sort('name') },
                    { text: 'Newest First', icon: 'access_time', action: () => Drive.sort('modified') },
                    { text: 'Largest First', icon: 'storage', action: () => Drive.sort('size') },
                    { text: 'Starred First', icon: 'star', action: () => Drive.sort('starred') }
                ]);
            },
            
            sort: (by) => {
                STATE.files.sort((a, b) => {
                    switch(by) {
                        case 'name': return a.name.localeCompare(b.name);
                        case 'modified': return new Date(b.modifiedTime) - new Date(a.modifiedTime);
                        case 'size': return (b.size || 0) - (a.size || 0);
                        case 'starred': return (b.starred ? 1 : 0) - (a.starred ? 1 : 0);
                        default: return 0;
                    }
                });
                Drive.renderVisibleItems();
            }
        };

        // ===================== CHUNKED UPLOAD WITH RESUME =====================
        const Upload = {
            queue: [],
            activeUploads: new Map(),
            
            handleFiles: (files) => {
                UI.toggleFab();
                Array.from(files).forEach(file => {
                    const upload = {
                        id: Date.now() + Math.random(),
                        file,
                        folder: STATE.currFolder,
                        progress: 0,
                        uploaded: 0,
                        status: 'pending',
                        chunkSize: CONFIG.chunkSize,
                        totalChunks: Math.ceil(file.size / CONFIG.chunkSize),
                        sessionUri: null,
                        retries: 0
                    };
                    
                    Upload.queue.push(upload);
                    Upload.saveQueue();
                });
                
                Upload.processQueue();
            },
            
            processQueue: async () => {
                if (STATE.session.offline) return;
                
                // Process up to 2 concurrent uploads
                const active = Array.from(Upload.activeUploads.values());
                const slots = 2 - active.length;
                
                for (let i = 0; i < Math.min(slots, Upload.queue.length); i++) {
                    const upload = Upload.queue[i];
                    if (upload.status === 'pending') {
                        upload.status = 'uploading';
                        Upload.activeUploads.set(upload.id, upload);
                        Upload.startUpload(upload);
                    }
                }
            },
            
            startUpload: async (upload) => {
                try {
                    // Create resumable session
                    const metadata = {
                        name: upload.file.name,
                        mimeType: upload.file.type,
                        parents: [upload.folder]
                    };
                    
                    const initRes = await fetch(
                        'https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable',
                        {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${STATE.token}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(metadata)
                        }
                    );
                    
                    upload.sessionUri = initRes.headers.get('Location');
                    
                    // Upload chunks
                    while (upload.uploaded < upload.file.size) {
                        const chunk = upload.file.slice(
                            upload.uploaded,
                            upload.uploaded + upload.chunkSize
                        );
                        
                        await Upload.uploadChunk(upload, chunk);
                        
                        if (upload.status === 'paused') break;
                    }
                    
                    if (upload.status === 'uploading') {
                        upload.status = 'completed';
                        Upload.activeUploads.delete(upload.id);
                        Upload.removeFromQueue(upload.id);
                        Drive.load(STATE.currFolder);
                    }
                    
                } catch (error) {
                    console.error('Upload failed:', error);
                    upload.retries++;
                    
                    if (upload.retries < CONFIG.maxRetries) {
                        setTimeout(() => Upload.startUpload(upload), 1000 * upload.retries);
                    } else {
                        upload.status = 'failed';
                        alert(`Failed to upload: ${upload.file.name}`);
                    }
                }
            },
            
            uploadChunk: async (upload, chunk) => {
                const start = upload.uploaded;
                const end = start + chunk.size - 1;
                
                const res = await fetch(upload.sessionUri, {
                    method: 'PUT',
                    headers: {
                        'Content-Length': chunk.size,
                        'Content-Range': `bytes ${start}-${end}/${upload.file.size}`,
                        'Content-Type': 'application/octet-stream'
                    },
                    body: chunk
                });
                
                if (res.status === 308) {
                    // Resume from where server says
                    const range = res.headers.get('Range');
                    if (range) {
                        const lastByte = parseInt(range.split('-')[1]);
                        upload.uploaded = lastByte + 1;
                    }
                } else if (res.status === 200 || res.status === 201) {
                    upload.uploaded = upload.file.size;
                }
                
                upload.progress = (upload.uploaded / upload.file.size) * 100;
                Upload.updateProgress(upload);
            },
            
            updateProgress: (upload) => {
                const modal = document.getElementById('progress-modal');
                const bar = document.getElementById('prog-bar');
                const pct = document.getElementById('prog-pct');
                const details = document.getElementById('prog-details');
                
                bar.style.width = upload.progress + '%';
                pct.innerText = Math.round(upload.progress) + '%';
                details.innerText = `${Ops.fmtSize(upload.uploaded)} / ${Ops.fmtSize(upload.file.size)}`;
            },
            
            pause: (id) => {
                const upload = Upload.activeUploads.get(id);
                if (upload) {
                    upload.status = 'paused';
                }
            },
            
            resume: (id) => {
                const upload = Upload.queue.find(u => u.id === id);
                if (upload) {
                    upload.status = 'pending';
                    Upload.processQueue();
                }
            },
            
            cancel: (id) => {
                Upload.activeUploads.delete(id);
                Upload.removeFromQueue(id);
            },
            
            saveQueue: () => {
                localStorage.setItem('upload_queue', JSON.stringify(Upload.queue));
            },
            
            removeFromQueue: (id) => {
                Upload.queue = Upload.queue.filter(u => u.id !== id);
                Upload.saveQueue();
            }
        };

        // ===================== ENHANCED MEDIA VIEWER =====================
        const MediaViewer = {
            currentType: null,
            player: null,
            
            open: async (file) => {
                const content = document.getElementById('media-content');
                content.innerHTML = '';
                
                // Hide all players
                ['pdf-viewer', 'video-player', 'audio-player', 'text-viewer', 'code-viewer', 'markdown-viewer']
                    .forEach(id => document.getElementById(id).style.display = 'none');
                
                if (file.mimeType.includes('image')) {
                    await MediaViewer.showImage(file);
                } else if (file.mimeType.includes('video')) {
                    await MediaViewer.showVideo(file);
                } else if (file.mimeType.includes('audio')) {
                    await MediaViewer.showAudio(file);
                } else if (file.mimeType === 'application/pdf') {
                    await MediaViewer.showPDF(file);
                } else if (file.mimeType === 'application/zip') {
                    await MediaViewer.showZip(file);
                } else if (file.mimeType.includes('text/plain') || file.mimeType.includes('text/')) {
                    await MediaViewer.showText(file);
                } else if (file.name.endsWith('.md')) {
                    await MediaViewer.showMarkdown(file);
                } else if (MediaViewer.isCodeFile(file.name)) {
                    await MediaViewer.showCode(file);
                } else {
                    // Fallback to Google Drive preview
                    document.getElementById('media-frame').src = 
                        `https://drive.google.com/file/d/${file.id}/preview`;
                    document.getElementById('media-frame').style.display = 'block';
                }
                
                document.getElementById('media-view').style.display = 'flex';
            },
            
            showImage: async (file) => {
                const img = document.createElement('img');
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'contain';
                img.style.padding = '20px';
                
                // Use thumbnail for faster loading
                if (file.thumbnailLink) {
                    img.src = file.thumbnailLink;
                }
                
                // Load full image in background
                const fullImg = new Image();
                fullImg.onload = () => {
                    img.src = fullImg.src;
                };
                fullImg.src = `https://drive.google.com/uc?export=view&id=${file.id}`;
                
                document.getElementById('media-content').appendChild(img);
            },
            
            showVideo: async (file) => {
                const video = document.getElementById('video-player');
                video.style.display = 'block';
                
                video.src = `https://drive.google.com/uc?export=download&id=${file.id}`;
                
                if (!MediaViewer.player) {
                    MediaViewer.player = new Plyr(video, {
                        controls: ['play', 'progress', 'current-time', 'mute', 'volume', 'fullscreen']
                    });
                } else {
                    MediaViewer.player.source = {
                        type: 'video',
                        sources: [{ src: video.src }]
                    };
                }
            },
            
            showAudio: async (file) => {
                const audio = document.getElementById('audio-player');
                audio.style.display = 'block';
                
                audio.src = `https://drive.google.com/uc?export=download&id=${file.id}`;
                
                if (!MediaViewer.player) {
                    MediaViewer.player = new Plyr(audio, {
                        controls: ['play', 'progress', 'current-time', 'mute', 'volume']
                    });
                } else {
                    MediaViewer.player.source = {
                        type: 'audio',
                        sources: [{ src: audio.src }]
                    };
                }
            },
            
            showPDF: async (file) => {
                const container = document.getElementById('pdf-viewer');
                container.style.display = 'block';
                
                // Load PDF.js
                const loadingTask = pdfjsLib.getDocument({
                    url: `https://drive.google.com/uc?export=download&id=${file.id}`,
                    withCredentials: true
                });
                
                const pdf = await loadingTask.promise;
                const page = await pdf.getPage(1);
                
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                
                const viewport = page.getViewport({ scale: 1.5 });
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                
                container.appendChild(canvas);
                
                await page.render({
                    canvasContext: context,
                    viewport: viewport
                }).promise;
            },
            
            showZip: async (file) => {
                UI.closeModal('ctx-modal');
                document.getElementById('zip-title').innerText = `ZIP: ${file.name}`;
                document.getElementById('zip-modal').style.display = 'flex';
                
                const response = await fetch(`https://drive.google.com/uc?export=download&id=${file.id}`);
                const buffer = await response.arrayBuffer();
                const zip = await JSZip.loadAsync(buffer);
                
                const container = document.getElementById('zip-contents');
                container.innerHTML = '';
                
                Object.keys(zip.files).forEach(filename => {
                    const item = zip.files[filename];
                    if (!item.dir) {
                        const div = document.createElement('div');
                        div.className = 'zip-item';
                        div.innerHTML = `
                            <span class="material-icons-round zip-icon">insert_drive_file</span>
                            <div style="flex:1">${filename}</div>
                            <span style="color:var(--text-sec);font-size:12px">
                                ${Ops.fmtSize(item._data.uncompressedSize)}
                            </span>
                        `;
                        
                        div.onclick = async () => {
                            const blob = await item.async('blob');
                            const url = URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = filename;
                            a.click();
                            URL.revokeObjectURL(url);
                        };
                        
                        container.appendChild(div);
                    }
                });
            },
            
            showText: async (file) => {
                const container = document.getElementById('text-viewer');
                container.style.display = 'block';
                
                const response = await fetch(`https://drive.google.com/uc?export=download&id=${file.id}`);
                const text = await response.text();
                
                container.textContent = text;
            },
            
            showMarkdown: async (file) => {
                const container = document.getElementById('markdown-viewer');
                container.style.display = 'block';
                
                const response = await fetch(`https://drive.google.com/uc?export=download&id=${file.id}`);
                const markdown = await response.text();
                
                container.innerHTML = marked.parse(markdown);
            },
            
            showCode: async (file) => {
                const container = document.getElementById('code-viewer');
                container.style.display = 'block';
                
                const response = await fetch(`https://drive.google.com/uc?export=download&id=${file.id}`);
                const code = await response.text();
                
                const pre = document.createElement('pre');
                const codeEl = document.createElement('code');
                codeEl.className = `language-${MediaViewer.getLanguage(file.name)}`;
                codeEl.textContent = code;
                pre.appendChild(codeEl);
                container.appendChild(pre);
                
                Prism.highlightElement(codeEl);
            },
            
            isCodeFile: (filename) => {
                const exts = ['.js', '.html', '.css', '.py', '.java', '.cpp', '.c', '.php', '.json', '.xml'];
                return exts.some(ext => filename.endsWith(ext));
            },
            
            getLanguage: (filename) => {
                const map = {
                    '.js': 'javascript',
                    '.html': 'html',
                    '.css': 'css',
                    '.py': 'python',
                    '.java': 'java',
                    '.cpp': 'cpp',
                    '.c': 'c',
                    '.php': 'php',
                    '.json': 'json',
                    '.xml': 'xml'
                };
                
                for (const [ext, lang] of Object.entries(map)) {
                    if (filename.endsWith(ext)) return lang;
                }
                return 'plaintext';
            }
        };

        // ===================== ADMIN SYSTEM =====================
        const Admin = {
            togglePanel: () => {
                const panel = document.getElementById('admin-panel');
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            },
            
            updateLogDisplay: () => {
                const logs = JSON.parse(localStorage.getItem('admin_logs') || '[]');
                const container = document.getElementById('admin-log');
                container.innerHTML = '';
                
                logs.slice(0, 20).forEach(log => {
                    const entry = document.createElement('div');
                    entry.className = 'log-entry';
                    entry.innerHTML = `
                        <div>
                            <strong>${log.action}</strong><br>
                            <small>${JSON.stringify(log.details)}</small>
                        </div>
                        <div class="log-time">${new Date(log.time).toLocaleTimeString()}</div>
                    `;
                    container.appendChild(entry);
                });
            },
            
            clearLogs: () => {
                localStorage.removeItem('admin_logs');
                Admin.updateLogDisplay();
            },
            
            enforceReadOnly: () => {
                if (!STATE.session.isAdmin) {
                    // Disable write operations
                    document.querySelector('.fab-container').style.display = 'none';
                    document.querySelectorAll('.action-list div')
                        .forEach(el => {
                            if (el.textContent.includes('Remove') || 
                                el.textContent.includes('Delete') ||
                                el.textContent.includes('Rename')) {
                                el.style.display = 'none';
                            }
                        });
                }
            }
        };

        // ===================== UI CONTROLLER ENHANCED =====================
        const UI = {
            switchScreen: (id) => {
                document.querySelectorAll('.screen').forEach(s => 
                    s.classList.remove('active'));
                document.getElementById(id).classList.add('active');
                
                if (id === 'app-screen') {
                    // Initialize virtual scroll
                    const container = document.getElementById('file-container');
                    container.onscroll = Drive.renderVisibleItems;
                    Drive.renderVisibleItems();
                    
                    // Initialize gestures
                    UI.initGestures();
                }
            },
            
            initGestures: () => {
                const swipeArea = document.getElementById('swipe-area');
                const indicator = document.getElementById('gesture-indicator');
                let startX = 0;
                
                swipeArea.addEventListener('touchstart', e => {
                    startX = e.touches[0].clientX;
                    indicator.style.opacity = '1';
                });
                
                swipeArea.addEventListener('touchmove', e => {
                    const delta = e.touches[0].clientX - startX;
                    if (delta > 0 && delta < 100) {
                        indicator.style.width = `${delta / 3}px`;
                    }
                });
                
                swipeArea.addEventListener('touchend', e => {
                    const delta = e.changedTouches[0].clientX - startX;
                    indicator.style.opacity = '0';
                    indicator.style.width = '4px';
                    
                    if (delta > 80) {
                        history.back();
                    }
                });
            },
            
            showActionSheet: (items) => {
                const sheet = document.createElement('div');
                sheet.className = 'modal-sheet';
                sheet.style.position = 'fixed';
                sheet.style.bottom = '0';
                sheet.style.left = '0';
                sheet.style.right = '0';
                sheet.style.background = 'var(--surface)';
                sheet.style.borderRadius = 'var(--radius-lg) var(--radius-lg) 0 0';
                sheet.style.padding = '20px';
                sheet.style.zIndex = '2000';
                
                items.forEach((item, i) => {
                    const div = document.createElement('div');
                    div.className = 'ctx-item';
                    div.style.padding = '15px';
                    div.style.display = 'flex';
                    div.style.alignItems = 'center';
                    div.style.gap = '15px';
                    div.style.borderBottom = '1px solid var(--border)';
                    div.style.animationDelay = `${i * 0.05}s`;
                    div.style.cursor = 'pointer';
                    
                    div.innerHTML = `
                        <span class="material-icons-round">${item.icon}</span>
                        <span>${item.text}</span>
                    `;
                    
                    div.onclick = () => {
                        item.action();
                        sheet.remove();
                    };
                    
                    sheet.appendChild(div);
                });
                
                const mask = document.createElement('div');
                mask.style.position = 'fixed';
                mask.style.top = '0';
                mask.style.left = '0';
                mask.style.right = '0';
                mask.style.bottom = '0';
                mask.style.background = 'rgba(0,0,0,0.5)';
                mask.style.zIndex = '1999';
                mask.onclick = () => {
                    sheet.remove();
                    mask.remove();
                };
                
                document.body.appendChild(mask);
                document.body.appendChild(sheet);
            },
            
            closeMedia: () => {
                document.getElementById('media-view').style.display = 'none';
                if (MediaViewer.player) {
                    MediaViewer.player.destroy();
                    MediaViewer.player = null;
                }
            }
        };

        // ===================== NETWORK MONITOR =====================
        const Network = {
            init: () => {
                setInterval(Network.checkSpeed, 30000);
                Network.checkSpeed();
            },
            
            checkSpeed: () => {
                const start = Date.now();
                fetch('https://www.google.com/favicon.ico?' + Date.now())
                    .then(() => {
                        const duration = Date.now() - start;
                        if (duration < 500) STATE.network.speed = 'fast';
                        else if (duration < 2000) STATE.network.speed = 'medium';
                        else STATE.network.speed = 'slow';
                        
                        Network.updateUI();
                    })
                    .catch(() => {
                        STATE.network.speed = 'offline';
                        Network.updateUI();
                    });
            },
            
            updateUI: () => {
                const dot = document.getElementById('network-dot');
                const text = document.getElementById('network-text');
                
                dot.className = 'network-dot ' + STATE.network.speed;
                text.textContent = STATE.network.speed.charAt(0).toUpperCase() + 
                                   STATE.network.speed.slice(1);
            }
        };

        // ===================== INITIALIZATION =====================
        window.onload = () => {
            if (!localStorage.getItem('app_pin')) {
                alert("Welcome! Create a 4-digit PIN for security");
            }
            
            Security.init();
            Auth.init();
            Network.init();
            
            // Load saved session
            const snapshot = localStorage.getItem('session_snapshot');
            if (snapshot) {
                const data = JSON.parse(snapshot);
                STATE.currFolder = data.folder || 'root';
                STATE.viewMode = data.view || 'list';
            }
            
            // Set up offline detection
            window.addEventListener('online', () => {
                STATE.session.offline = false;
                Upload.processQueue();
            });
            
            window.addEventListener('offline', () => {
                STATE.session.offline = true;
            });
            
            // Save session on unload
            window.addEventListener('beforeunload', () => {
                localStorage.setItem('session_snapshot', JSON.stringify({
                    folder: STATE.currFolder,
                    view: STATE.viewMode,
                    scroll: document.getElementById('file-container').scrollTop
                }));
            });
            
            // Handle back button
            window.onpopstate = (e) => {
                if (e.state && e.state.folderId) {
                    Drive.load(e.state.folderId);
                }
            };
        };

        // Add shake animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>