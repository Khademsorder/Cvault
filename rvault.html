<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üì¶ Hybrid Vault (Offline+Online)</title>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <!-- Google APIs -->
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <style>
        /* ===== VARIABLES & RESET ===== */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg: #0f172a;
            --surface: #1e293b;
            --surface-light: #334155;
            --text: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #475569;
            --radius: 16px;
            --radius-sm: 8px;
            --shadow: 0 4px 20px rgba(0,0,0,0.3);
            --shadow-lg: 0 10px 40px rgba(0,0,0,0.5);
            --online: #10b981;
            --offline: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* ===== ANIMATIONS ===== */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideDown {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ===== LOADING SCREEN ===== */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.5s ease;
        }

        .loading-content {
            text-align: center;
            animation: float 3s ease-in-out infinite;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
            position: relative;
        }

        .loading-spinner::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border-radius: 50%;
            border: 3px solid transparent;
            border-top-color: var(--secondary);
            animation: spin 1.5s linear infinite reverse;
        }

        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--primary));
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: shimmer 2s linear infinite;
        }

        .loading-subtext {
            color: var(--text-secondary);
            margin-top: 10px;
            font-size: 0.9rem;
        }

        /* ===== CONNECTION STATUS ===== */
        .connection-status {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 9999;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            animation: slideDown 0.5s ease-out;
        }

        .connection-status.online {
            background: rgba(16, 185, 129, 0.2);
            color: var(--online);
            border-color: var(--online);
        }

        .connection-status.offline {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
            border-color: var(--warning);
        }

        .connection-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .connection-status.online .connection-dot {
            background: var(--online);
            box-shadow: 0 0 10px var(--online);
        }

        .connection-status.offline .connection-dot {
            background: var(--warning);
            box-shadow: 0 0 10px var(--warning);
        }

        /* ===== AUTH SCREEN ===== */
        #authScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 9000;
            animation: fadeIn 0.5s ease;
        }

        #authScreen.active {
            display: flex;
        }

        .auth-container {
            max-width: 400px;
            width: 100%;
            text-align: center;
            animation: fadeIn 0.8s ease 0.3s both;
        }

        .app-logo {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
            display: inline-block;
        }

        .app-title {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .app-subtitle {
            color: var(--text-secondary);
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        /* ===== MAIN APP ===== */
        #mainScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            z-index: 1000;
        }

        #mainScreen.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }

        /* HEADER */
        .app-header {
            padding: 15px 20px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.5s ease-out;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            animation: pulse 3s infinite;
        }

        .header-title {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .header-stats {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .stat-count {
            background: var(--surface);
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 700;
            color: var(--primary);
        }

        /* GALLERY */
        .gallery-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            position: relative;
        }

        .upload-fab {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 100;
            transition: all 0.3s;
            animation: bounce 2s infinite;
        }

        .upload-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(99, 102, 241, 0.4);
        }

        .upload-fab:active {
            transform: scale(0.95);
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 70vh;
            text-align: center;
            color: var(--text-secondary);
            animation: fadeIn 0.8s ease;
        }

        .empty-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            opacity: 0.5;
            animation: float 3s ease-in-out infinite;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
            animation: fadeIn 0.5s ease;
        }

        .file-card {
            background: var(--surface);
            border-radius: var(--radius);
            overflow: hidden;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .file-card:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
        }

        .file-card:active {
            transform: translateY(-2px) scale(1.01);
        }

        .file-preview {
            width: 100%;
            height: 140px;
            background: linear-gradient(135deg, var(--primary), var(--surface-light));
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .file-preview::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 2s infinite linear;
        }

        .file-icon {
            font-size: 3rem;
            color: white;
            z-index: 1;
        }

        .file-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            z-index: 2;
        }

        .file-info {
            padding: 15px;
        }

        .file-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .file-size {
            background: var(--surface-light);
            padding: 2px 8px;
            border-radius: 10px;
        }

        /* BOTTOM NAV */
        .bottom-nav {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--border);
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            position: sticky;
            bottom: 0;
            z-index: 100;
            animation: slideUp 0.5s ease-out;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: var(--radius);
            transition: all 0.3s;
            min-width: 70px;
            position: relative;
        }

        .nav-item:hover {
            color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            transform: translateY(-2px);
        }

        .nav-item.active {
            color: var(--primary);
            background: rgba(99, 102, 241, 0.15);
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-icon {
            font-size: 1.4rem;
            margin-bottom: 5px;
            transition: transform 0.3s;
        }

        .nav-item:hover .nav-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .nav-text {
            font-size: 0.75rem;
            font-weight: 600;
        }

        .nav-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--danger);
            color: white;
            font-size: 0.6rem;
            padding: 2px 6px;
            border-radius: 10px;
            animation: pulse 1.5s infinite;
        }

        /* ===== MODALS ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--surface);
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow: hidden;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-lg);
            transform: scale(0.9);
            animation: fadeIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, var(--surface), var(--surface-light));
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--surface-light);
            color: var(--text);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 25px;
            overflow-y: auto;
        }

        /* ===== UPLOAD MODAL ===== */
        .upload-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .upload-option {
            background: var(--surface-light);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .upload-option:hover {
            transform: translateY(-5px) scale(1.05);
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .upload-option.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(16, 185, 129, 0.1));
            animation: pulse 2s infinite;
        }

        .upload-option:active {
            transform: scale(0.95);
        }

        .upload-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
        }

        .upload-name {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .upload-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .file-drop-area {
            border: 3px dashed var(--border);
            border-radius: var(--radius);
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .file-drop-area:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
            transform: scale(1.02);
        }

        .file-drop-area.dragover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            animation: pulse 0.5s;
        }

        .file-drop-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            opacity: 0.7;
            display: block;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        /* ===== PIN SYSTEM ===== */
        .pin-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }

        .pin-digit {
            width: 60px;
            height: 70px;
            border: 3px solid var(--border);
            border-radius: var(--radius);
            font-size: 2rem;
            text-align: center;
            background: var(--surface-light);
            color: var(--text);
            transition: all 0.3s;
            font-weight: 700;
        }

        .pin-digit:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.3);
            transform: scale(1.1);
            background: var(--surface);
        }

        .pin-digit.filled {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            animation: bounce 0.3s;
        }

        .pin-hint {
            text-align: center;
            color: var(--text-secondary);
            margin-top: 10px;
            font-size: 0.9rem;
        }

        /* ===== PROGRESS ===== */
        .progress-container {
            margin: 25px 0;
            display: none;
        }

        .progress-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .progress-bar {
            height: 8px;
            background: var(--surface-light);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 2s infinite linear;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 4px;
            position: relative;
            z-index: 1;
        }

        /* ===== BUTTONS ===== */
        .btn {
            padding: 14px 28px;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            border: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
        }

        .btn:hover::after {
            animation: shimmer 0.5s;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.6);
        }

        .btn-secondary {
            background: var(--surface-light);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .btn-block {
            width: 100%;
        }

        .btn-icon {
            font-size: 1.2rem;
        }

        /* ===== TOAST NOTIFICATION ===== */
        .toast-container {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10001;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
            width: 90%;
        }

        .toast {
            background: var(--surface);
            color: var(--text);
            padding: 16px 24px;
            border-radius: var(--radius);
            border-left: 5px solid var(--primary);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 15px;
            transform: translateY(100px) scale(0.9);
            opacity: 0;
            animation: slideUp 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
        }

        .toast.show {
            animation: slideUp 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        .toast.hide {
            animation: slideUp 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) reverse forwards;
        }

        .toast.success {
            border-left-color: var(--secondary);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), var(--surface));
        }

        .toast.error {
            border-left-color: var(--danger);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), var(--surface));
        }

        .toast.warning {
            border-left-color: var(--warning);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), var(--surface));
        }

        .toast.info {
            border-left-color: var(--info);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), var(--surface));
        }

        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .toast-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: var(--primary);
            width: 100%;
            transform-origin: left;
            animation: progress 3s linear forwards;
        }

        @keyframes progress {
            from { transform: scaleX(1); }
            to { transform: scaleX(0); }
        }

        /* ===== SYNC STATUS ===== */
        .sync-status {
            position: fixed;
            top: 70px;
            right: 20px;
            background: var(--surface);
            padding: 12px 20px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            display: none;
            align-items: center;
            gap: 10px;
            z-index: 999;
            animation: fadeIn 0.5s ease;
        }

        .sync-status.show {
            display: flex;
        }

        .sync-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* ===== FILE VIEWER MODAL ===== */
        .file-viewer {
            max-width: 800px;
            width: 95%;
        }

        .file-preview-container {
            width: 100%;
            height: 400px;
            background: var(--surface-light);
            border-radius: var(--radius);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
        }

        .file-preview-container img,
        .file-preview-container video {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .file-details {
            background: var(--surface-light);
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        /* ===== SETTINGS MODAL ===== */
        .settings-section {
            background: var(--surface-light);
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
        }

        .settings-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .upload-options {
                grid-template-columns: 1fr;
            }
            
            .pin-digit {
                width: 50px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .file-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 15px;
            }
            
            .modal {
                width: 95%;
                margin: 10px;
            }
        }

        @media (max-width: 480px) {
            .header-stats {
                display: none;
            }
            
            .pin-digit {
                width: 45px;
                height: 55px;
            }
            
            .nav-text {
                font-size: 0.7rem;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .text-center { text-align: center; }
        .mt-1 { margin-top: 5px; }
        .mt-2 { margin-top: 10px; }
        .mt-3 { margin-top: 15px; }
        .mt-4 { margin-top: 20px; }
        .mt-5 { margin-top: 25px; }
        .mb-1 { margin-bottom: 5px; }
        .mb-2 { margin-bottom: 10px; }
        .mb-3 { margin-bottom: 15px; }
        .mb-4 { margin-bottom: 20px; }
        .mb-5 { margin-bottom: 25px; }
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-flex { display: flex !important; }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Hybrid Vault ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá</div>
            <div class="loading-subtext">‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®+‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶®‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®</div>
        </div>
    </div>

    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status offline">
        <div class="connection-dot"></div>
        <span id="connectionText">‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°</span>
    </div>

    <!-- Sync Status -->
    <div id="syncStatus" class="sync-status">
        <div class="sync-spinner"></div>
        <span>‡¶∏‡¶ø‡¶ô‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶®‡¶æ‡¶á‡¶ú‡¶ø‡¶Ç...</span>
    </div>

    <!-- Auth Screen -->
    <div id="authScreen">
        <div class="auth-container">
            <div class="app-logo">üì¶</div>
            <h1 class="app-title">Hybrid Vault</h1>
            <p class="app-subtitle">‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú + ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™<br>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶∞‡ßç‡¶¨‡¶¶‡¶æ ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§</p>
            
            <div class="auth-buttons">
                <button id="googleSignInBtn" class="btn btn-primary">
                    <span class="btn-icon">üîê</span>
                    ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
                <button id="offlineModeBtn" class="btn btn-secondary">
                    <span class="btn-icon">üì¥</span>
                    ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainScreen">
        <!-- Header -->
        <div class="app-header">
            <div class="header-left">
                <div class="header-icon">üì¶</div>
                <div class="header-title">Hybrid Vault</div>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <span>‡¶´‡¶æ‡¶á‡¶≤:</span>
                    <span id="fileCount" class="stat-count">0</span>
                </div>
                <div class="stat-item">
                    <span>‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú:</span>
                    <span id="storageUsed" class="stat-count">0 MB</span>
                </div>
            </div>
        </div>

        <!-- Gallery -->
        <div class="gallery-container">
            <div id="emptyState" class="empty-state">
                <div class="empty-icon">üìÅ</div>
                <h3>‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡ßá‡¶á</h3>
                <p>‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                <div class="mt-4">
                    <button id="quickUploadBtn" class="btn btn-primary mb-2">
                        <span class="btn-icon">üì§</span> ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°
                    </button>
                    <button id="syncDriveBtn" class="btn btn-secondary">
                        <span class="btn-icon">üîÑ</span> ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï
                    </button>
                </div>
            </div>
            <div id="fileGrid" class="file-grid"></div>
        </div>

        <!-- FAB -->
        <div class="upload-fab" onclick="openUploadModal()">
            <span style="font-size: 1.8rem;">+</span>
        </div>

        <!-- Bottom Nav -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="switchTab('gallery')">
                <div class="nav-icon">üìÅ</div>
                <div class="nav-text">‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</div>
            </div>
            <div class="nav-item" onclick="switchTab('drive')">
                <div class="nav-icon">‚òÅÔ∏è</div>
                <div class="nav-text">‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠</div>
                <div id="driveBadge" class="nav-badge">0</div>
            </div>
            <div class="nav-item" onclick="switchTab('backup')">
                <div class="nav-icon">üîÑ</div>
                <div class="nav-text">‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™</div>
            </div>
            <div class="nav-item" onclick="switchTab('settings')">
                <div class="nav-icon">‚öôÔ∏è</div>
                <div class="nav-text">‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</div>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="uploadModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‡¶´‡¶æ‡¶á‡¶≤ ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶ì ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</div>
                <button class="modal-close" onclick="closeModal('uploadModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="upload-options">
                    <div class="upload-option selected" onclick="selectUploadType('single')">
                        <div class="upload-icon">üìÑ</div>
                        <div class="upload-name">‡¶è‡¶ï‡¶ï ‡¶´‡¶æ‡¶á‡¶≤</div>
                        <div class="upload-desc">‡¶è‡¶ï‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</div>
                    </div>
                    <div class="upload-option" onclick="selectUploadType('folder')">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-name">‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞</div>
                        <div class="upload-desc">‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</div>
                    </div>
                </div>

                <div class="file-drop-area" id="fileDropArea">
                    <div class="file-drop-icon">üìÇ</div>
                    <div class="upload-name" id="dropText">‡¶´‡¶æ‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡ßç‡¶∞‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                    <div class="upload-desc">‡¶Ö‡¶•‡¶¨‡¶æ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                    <input type="file" id="fileInput" class="file-input" multiple>
                    <input type="file" id="folderInput" class="file-input d-none" webkitdirectory directory multiple>
                </div>

                <div id="selectedFiles" class="d-none">
                    <div class="mb-3">
                        <div class="upload-name">‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü‡ßá‡¶° ‡¶´‡¶æ‡¶á‡¶≤</div>
                        <div id="fileList" class="upload-desc"></div>
                    </div>
                </div>

                <div class="pin-container">
                    <input type="password" class="pin-digit" maxlength="1" oninput="movePinFocus(1)">
                    <input type="password" class="pin-digit" maxlength="1" oninput="movePinFocus(2)">
                    <input type="password" class="pin-digit" maxlength="1" oninput="movePinFocus(3)">
                    <input type="password" class="pin-digit" maxlength="1" oninput="movePinFocus(4)">
                </div>
                <div class="pin-hint">‡ß™-‡¶°‡¶ø‡¶ú‡¶ø‡¶ü ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® PIN ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶Æ‡¶®‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®!)</div>

                <div class="progress-container" id="uploadProgress">
                    <div class="progress-header">
                        <span id="progressText">‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div class="mt-4">
                    <button id="startUploadBtn" class="btn btn-primary btn-block" onclick="startEncryption()">
                        <span class="btn-icon">üîí</span> ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
                    </button>
                    <button class="btn btn-secondary btn-block mt-2" onclick="closeModal('uploadModal')">
                        ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- File Viewer Modal -->
    <div id="fileViewerModal" class="modal-overlay">
        <div class="modal file-viewer">
            <div class="modal-header">
                <div class="modal-title" id="viewerTitle">‡¶´‡¶æ‡¶á‡¶≤ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div>
                <button class="modal-close" onclick="closeModal('fileViewerModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="file-preview-container" id="filePreviewContainer">
                    <div class="empty-icon">üîí</div>
                </div>
                
                <div class="file-details">
                    <div class="detail-row">
                        <span>‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶Æ:</span>
                        <span id="detailFileName">-</span>
                    </div>
                    <div class="detail-row">
                        <span>‡¶Ü‡¶ï‡¶æ‡¶∞:</span>
                        <span id="detailFileSize">-</span>
                    </div>
                    <div class="detail-row">
                        <span>‡¶ü‡¶æ‡¶á‡¶™:</span>
                        <span id="detailFileType">-</span>
                    </div>
                    <div class="detail-row">
                        <span>‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</span>
                        <span id="detailUploadDate">-</span>
                    </div>
                    <div class="detail-row">
                        <span>‡¶â‡ßé‡¶∏:</span>
                        <span id="detailSource">-</span>
                    </div>
                </div>

                <div class="pin-container" id="viewerPinContainer">
                    <input type="password" class="pin-digit" maxlength="1" oninput="moveViewerPinFocus(1)" placeholder="‚Ä¢">
                    <input type="password" class="pin-digit" maxlength="1" oninput="moveViewerPinFocus(2)" placeholder="‚Ä¢">
                    <input type="password" class="pin-digit" maxlength="1" oninput="moveViewerPinFocus(3)" placeholder="‚Ä¢">
                    <input type="password" class="pin-digit" maxlength="1" oninput="moveViewerPinFocus(4)" placeholder="‚Ä¢">
                </div>
                <div class="pin-hint">‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡ß™-‡¶°‡¶ø‡¶ú‡¶ø‡¶ü PIN ‡¶¶‡¶ø‡¶®</div>

                <div class="progress-container" id="decryptProgress">
                    <div class="progress-header">
                        <span id="decryptProgressText">‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§...</span>
                        <span id="decryptProgressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="decryptProgressFill"></div>
                    </div>
                </div>

                <div class="mt-4">
                    <button id="decryptBtn" class="btn btn-primary btn-block" onclick="decryptAndViewFile()">
                        <span class="btn-icon">üîì</span> ‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                    </button>
                    <button class="btn btn-secondary btn-block mt-2" onclick="closeModal('fileViewerModal')">
                        ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</div>
                <button class="modal-close" onclick="closeModal('settingsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <div class="settings-title">‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</div>
                    <div class="setting-item">
                        <span>‡¶Ö‡¶ü‡ßã-‡¶∏‡¶ø‡¶ô‡ßç‡¶ï (‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶π‡¶≤‡ßá)</span>
                        <label class="switch">
                            <input type="checkbox" id="autoSyncToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <span>‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ</span>
                        <label class="switch">
                            <input type="checkbox" id="offlineWarningToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <span>PIN ‡¶∏‡ßç‡¶¨‡¶∞‡¶≤‡¶ø‡¶™‡¶ø ‡¶∂‡ßá‡ßü‡¶æ‡¶∞</span>
                        <label class="switch">
                            <input type="checkbox" id="pinHintToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</div>
                    <div class="setting-item">
                        <span>‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶∏‡ßÄ‡¶Æ‡¶æ</span>
                        <select id="cacheLimitSelect" class="btn-secondary" style="padding: 5px 10px;">
                            <option value="100">100 MB</option>
                            <option value="500" selected>500 MB</option>
                            <option value="1000">1 GB</option>
                            <option value="2000">2 GB</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <span>‡¶Ö‡¶ü‡ßã ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶Ü‡¶™ (‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤)</span>
                        <label class="switch">
                            <input type="checkbox" id="autoCleanupToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø</div>
                    <div class="setting-item">
                        <span>‡¶Ö‡¶ü‡ßã ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü (‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü)</span>
                        <select id="autoLogoutSelect" class="btn-secondary" style="padding: 5px 10px;">
                            <option value="0">‡¶¨‡¶®‡ßç‡¶ß</option>
                            <option value="5">5 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</option>
                            <option value="15" selected>15 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</option>
                            <option value="30">30 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</option>
                            <option value="60">1 ‡¶ò‡¶®‡ßç‡¶ü‡¶æ</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <span>‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø‡¶™‡¶≤ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶≤‡¶ó‡¶á‡¶®</span>
                        <label class="switch">
                            <input type="checkbox" id="multiDeviceToggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü</div>
                    <div class="setting-item">
                        <span>‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞:</span>
                        <span id="loggedInUser">‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°</span>
                    </div>
                    <div class="mt-4">
                        <button class="btn btn-secondary btn-block" onclick="clearLocalCache()">
                            <span class="btn-icon">üóëÔ∏è</span> ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                        <button class="btn btn-danger btn-block mt-2" onclick="signOut()">
                            <span class="btn-icon">üö™</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                    </div>
                </div>

                <div class="text-center mt-4">
                    <div style="color: var(--text-secondary); font-size: 0.8rem;">
                        Hybrid Vault v2.0.0<br>
                        ¬© 2024 ‡¶∏‡¶∞‡ßç‡¶¨‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶§‡ßç‡¶¨ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ================================================
        // CONFIGURATION (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ API ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá)
        // ================================================
        const CONFIG = {
            // Firebase Configuration
            firebase: {
                apiKey: "AIzaSyB3Iy1MIbfmJ7h5rv9NlsT23ysedCwUZt4",
                authDomain: "encrypted-vault-4683d.firebaseapp.com",
                projectId: "encrypted-vault-4683d",
                storageBucket: "encrypted-vault-4683d.appspot.com",
                messagingSenderId: "851257263743",
                appId: "1:851257263743:web:e0d16606bd06f692f5e14a"
            },
            
            // Google Apps Script
            googleAppsScript: {
                deploymentUrl: "https://script.google.com/macros/s/AKfycbz_TPcGqyQDakoZ2S_oM8D_KJEWM9WB3KvxeRMeUTAXCeiLuBazIS1QWlvpD-EvHcaWfw/exec",
                scriptId: "1z9C_jf74wDDpBC5ofPyBZ_zPOrJjt2IFJVYNFPkea6oe70eXThesaRnp"
            },
            
            // Google Drive
            googleDrive: {
                folderId: "1zIyinAqjQv96QBSuanFS2F0USaG66GPn",
                folderLink: "https://drive.google.com/drive/folders/1zIyinAqjQv96QBSuanFS2F0USaG66GPn"
            },
            
            // OAuth Client ID
            googleClientId: "318681315152-65e9kofptt4c3bk3kmlj9gmksnasu347.apps.googleusercontent.com",
            
            // App Info
            appName: "Hybrid Vault",
            version: "2.0.0",
            
            // Security Settings
            maxFileSize: 100 * 1024 * 1024, // 100MB
            pinLength: 4,
            allowedFileTypes: [
                'image/jpeg', 'image/png', 'image/gif', 'image/webp',
                'application/pdf', 'text/plain', 'application/msword',
                'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'video/mp4', 'video/webm', 'audio/mpeg'
            ]
        };

        // ================================================
        // GLOBAL VARIABLES
        // ================================================
        let db, auth, currentUser, googleUser, tokenClient;
        let selectedFiles = [];
        let selectedUploadType = 'single';
        let currentPIN = '';
        let viewerPIN = '';
        let isOnline = navigator.onLine;
        let syncQueue = [];
        let syncInProgress = false;
        let currentViewingFile = null;
        let inactivityTimer = null;
        let autoSyncEnabled = true;
        let settings = {
            autoSync: true,
            offlineWarning: true,
            pinHint: false,
            cacheLimit: 500,
            autoCleanup: false,
            autoLogout: 15,
            multiDevice: true
        };

        // ================================================
        // INITIALIZATION
        // ================================================
        async function initApp() {
            try {
                showToast('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                
                // Load settings from localStorage
                loadSettings();
                
                // Initialize Firebase
                showToast('‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                const app = firebase.initializeApp(CONFIG.firebase);
                auth = firebase.auth();
                db = firebase.firestore();
                
                // Enable offline persistence
                try {
                    await db.enablePersistence({ synchronizeTabs: true });
                    showToast('‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡ßü', 'success');
                } catch (persistenceError) {
                    console.warn('Offline persistence failed:', persistenceError);
                    showToast('‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶∏‡ßÄ‡¶Æ‡¶ø‡¶§', 'warning');
                }
                
                // Load offline files
                await loadOfflineFiles();
                
                // Check auth state
                auth.onAuthStateChanged(handleAuthStateChange);
                
                // Network status management
                updateConnectionStatus();
                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);
                
                // Initialize inactivity timer
                if (settings.autoLogout > 0) {
                    initInactivityTimer();
                }
                
                // Auto sync check
                if (isOnline && syncQueue.length > 0 && settings.autoSync) {
                    setTimeout(startSync, 3000);
                }
                
                // Hide loading screen with delay
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.display = 'none';
                    showToast('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§!', 'success');
                }, 1500);
                
            } catch (error) {
                console.error('Initialization error:', error);
                document.getElementById('loadingScreen').style.display = 'none';
                showToast('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
                document.getElementById('authScreen').classList.add('active');
            }
        }

        // ================================================
        // AUTHENTICATION
        // ================================================
        async function handleAuthStateChange(user) {
            currentUser = user;
            
            if (user) {
                // User is signed in
                showToast(`‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ ${user.displayName || '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ'}!`, 'success');
                document.getElementById('authScreen').classList.remove('active');
                document.getElementById('mainScreen').classList.add('active');
                
                // Update user info in settings
                document.getElementById('loggedInUser').textContent = user.displayName || user.email;
                
                // Initialize Google APIs
                try {
                    await initGoogleAPIs();
                    showToast('‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§', 'success');
                } catch (error) {
                    console.warn('Google API init failed:', error);
                    showToast('‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• (‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶ö‡¶≤‡¶¨‡ßá)', 'warning');
                }
                
                // Load files
                await loadFiles();
                
                // Reset inactivity timer
                if (settings.autoLogout > 0) {
                    resetInactivityTimer();
                }
                
            } else {
                // User is signed out
                document.getElementById('authScreen').classList.add('active');
                document.getElementById('mainScreen').classList.remove('active');
                document.getElementById('loggedInUser').textContent = '‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°';
            }
        }

        async function signInWithGoogle() {
            try {
                showToast('‡¶≤‡¶ó‡¶á‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.addScope('https://www.googleapis.com/auth/drive.file');
                provider.setCustomParameters({
                    prompt: 'select_account'
                });
                
                await auth.signInWithPopup(provider);
                
            } catch (error) {
                console.error('Sign in error:', error);
                
                if (error.code === 'auth/popup-blocked') {
                    showToast('‡¶™‡¶™‡¶Ü‡¶™ ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá‡•§ ‡¶™‡¶™‡¶Ü‡¶™ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¶‡¶ø‡¶®‡•§', 'error');
                } else if (error.code === 'auth/popup-closed-by-user') {
                    showToast('‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§', 'warning');
                } else if (error.code === 'auth/network-request-failed') {
                    showToast('‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                } else {
                    showToast('‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                }
            }
        }

        async function startOfflineMode() {
            showToast('‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
            
            currentUser = { 
                uid: 'offline_user_' + Date.now(), 
                displayName: '‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞',
                email: 'offline@vault.local'
            };
            
            document.getElementById('authScreen').classList.remove('active');
            document.getElementById('mainScreen').classList.add('active');
            
            // Update user info
            document.getElementById('loggedInUser').textContent = '‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°';
            
            // Load files
            await loadFiles();
            
            showToast('‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
        }

        async function signOut() {
            try {
                showToast('‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                
                // Clear sync queue
                syncQueue = [];
                
                // Clear inactivity timer
                if (inactivityTimer) {
                    clearTimeout(inactivityTimer);
                    inactivityTimer = null;
                }
                
                // Sign out from Firebase
                if (auth.currentUser) {
                    await auth.signOut();
                }
                
                // Reset to offline mode
                currentUser = null;
                googleUser = null;
                tokenClient = null;
                
                closeModal('settingsModal');
                showToast('‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
                
            } catch (error) {
                console.error('Sign out error:', error);
                showToast('‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•', 'error');
            }
        }

        // ================================================
        // NETWORK MANAGEMENT
        // ================================================
        function updateConnectionStatus() {
            const statusEl = document.getElementById('connectionStatus');
            const textEl = document.getElementById('connectionText');
            
            if (navigator.onLine) {
                isOnline = true;
                statusEl.className = 'connection-status online';
                textEl.textContent = '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°';
                
                // Auto sync when coming online
                if (currentUser && syncQueue.length > 0 && settings.autoSync) {
                    setTimeout(() => {
                        showToast('‡¶Ö‡¶ü‡ßã ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                        startSync();
                    }, 2000);
                }
                
            } else {
                isOnline = false;
                statusEl.className = 'connection-status offline';
                textEl.textContent = '‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°';
                
                if (settings.offlineWarning) {
                    showToast('‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°‡•§ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶π‡¶¨‡ßá‡•§', 'warning');
                }
            }
        }

        function handleOnline() {
            showToast('‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡¶æ‡¶∞ ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
            updateConnectionStatus();
        }

        function handleOffline() {
            showToast('‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡¶ø‡¶ö‡ßç‡¶õ‡¶ø‡¶®‡ßç‡¶®', 'error');
            updateConnectionStatus();
        }

        // ================================================
        // FILE MANAGEMENT (OFFLINE + ONLINE)
        // ================================================
        async function loadFiles() {
            try {
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                
                // Load offline files
                const offlineFiles = await getAllOfflineFiles();
                
                // Load online files if user is signed in and online
                let onlineFiles = [];
                if (currentUser && currentUser.uid !== 'offline_user' && isOnline) {
                    try {
                        onlineFiles = await getOnlineFiles();
                    } catch (error) {
                        console.warn('Online files load failed:', error);
                        showToast('‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•', 'warning');
                    }
                }
                
                // Merge and sort files by date
                const allFiles = [...offlineFiles, ...onlineFiles]
                    .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                // Update UI
                updateFileGrid(allFiles);
                updateStats(allFiles);
                
                // Update drive badge
                const driveCount = onlineFiles.length;
                const driveBadge = document.getElementById('driveBadge');
                if (driveCount > 0) {
                    driveBadge.textContent = driveCount;
                    driveBadge.style.display = 'block';
                } else {
                    driveBadge.style.display = 'none';
                }
                
                showToast(`${allFiles.length}‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£`, 'success');
                
            } catch (error) {
                console.error('Load files error:', error);
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•', 'error');
            }
        }

        async function getAllOfflineFiles() {
            return new Promise((resolve) => {
                const request = indexedDB.open('HybridVaultDB', 3);
                
                request.onupgradeneeded = (e) => {
                    const db = e.target.result;
                    if (!db.objectStoreNames.contains('files')) {
                        const store = db.createObjectStore('files', { keyPath: 'id' });
                        store.createIndex('createdAt', 'createdAt', { unique: false });
                        store.createIndex('needsSync', 'needsSync', { unique: false });
                    }
                };
                
                request.onsuccess = (e) => {
                    const db = e.target.result;
                    const transaction = db.transaction(['files'], 'readonly');
                    const store = transaction.objectStore('files');
                    const index = store.index('createdAt');
                    const getAllRequest = index.getAll();
                    
                    getAllRequest.onsuccess = () => {
                        resolve(getAllRequest.result || []);
                    };
                    
                    getAllRequest.onerror = () => {
                        console.error('IndexedDB getAll error:', getAllRequest.error);
                        resolve([]);
                    };
                };
                
                request.onerror = (e) => {
                    console.error('IndexedDB open error:', e.target.error);
                    resolve([]);
                };
            });
        }

        async function getOnlineFiles() {
            if (!currentUser || currentUser.uid === 'offline_user') return [];
            
            try {
                const snapshot = await db.collection('files')
                    .where('ownerId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .limit(100)
                    .get();
                
                return snapshot.docs.map(doc => ({ 
                    ...doc.data(), 
                    id: doc.id, 
                    source: 'online',
                    dbId: doc.id
                }));
            } catch (error) {
                console.error('Get online files error:', error);
                throw error;
            }
        }

        function updateFileGrid(files) {
            const fileGrid = document.getElementById('fileGrid');
            const emptyState = document.getElementById('emptyState');
            
            if (files.length === 0) {
                fileGrid.innerHTML = '';
                emptyState.style.display = 'flex';
                return;
            }
            
            emptyState.style.display = 'none';
            fileGrid.innerHTML = '';
            
            files.forEach(file => {
                const card = createFileCard(file);
                fileGrid.appendChild(card);
            });
        }

        function createFileCard(file) {
            const card = document.createElement('div');
            card.className = 'file-card';
            card.onclick = () => openFileViewer(file);
            
            let icon = 'üìÑ';
            if (file.metadata?.fileType?.startsWith('image/')) icon = 'üñºÔ∏è';
            else if (file.metadata?.fileType?.startsWith('video/')) icon = 'üé¨';
            else if (file.metadata?.fileType?.startsWith('audio/')) icon = 'üéµ';
            else if (file.metadata?.fileType?.includes('pdf')) icon = 'üìï';
            else if (file.metadata?.fileType?.includes('word')) icon = 'üìù';
            
            const sourceBadge = file.source === 'online' ? '‚òÅÔ∏è' : 'üì±';
            const size = file.metadata?.fileSize ? formatFileSize(file.metadata.fileSize) : '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ';
            const fileName = file.metadata?.fileName || file.fileName || 'Unnamed File';
            const createdAt = file.createdAt || file.metadata?.createdAt || Date.now();
            
            card.innerHTML = `
                <div class="file-preview">
                    <div class="file-icon">${icon}</div>
                    <div class="file-badge">${sourceBadge}</div>
                    ${file.needsSync ? '<div class="file-badge" style="top: 40px; background: var(--warning);">üîÑ</div>' : ''}
                </div>
                <div class="file-info">
                    <div class="file-name" title="${fileName}">${fileName}</div>
                    <div class="file-meta">
                        <div class="file-size">${size}</div>
                        <div>${formatDate(createdAt)}</div>
                    </div>
                </div>
            `;
            
            return card;
        }

        function updateStats(files) {
            document.getElementById('fileCount').textContent = files.length;
            
            const totalSize = files.reduce((sum, file) => sum + (file.metadata?.fileSize || file.fileSize || 0), 0);
            document.getElementById('storageUsed').textContent = formatFileSize(totalSize);
        }

        // ================================================
        // FILE VIEWER & DECRYPTION
        // ================================================
        async function openFileViewer(file) {
            currentViewingFile = file;
            
            // Update file details
            document.getElementById('viewerTitle').textContent = '‡¶´‡¶æ‡¶á‡¶≤ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®';
            document.getElementById('detailFileName').textContent = file.metadata?.fileName || file.fileName || 'Unnamed File';
            document.getElementById('detailFileSize').textContent = formatFileSize(file.metadata?.fileSize || file.fileSize || 0);
            document.getElementById('detailFileType').textContent = file.metadata?.fileType || file.fileType || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ';
            document.getElementById('detailUploadDate').textContent = formatDate(file.createdAt || file.metadata?.createdAt);
            document.getElementById('detailSource').textContent = file.source === 'online' ? '‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠' : '‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú';
            
            // Reset PIN
            viewerPIN = '';
            document.querySelectorAll('#viewerPinContainer .pin-digit').forEach(input => {
                input.value = '';
                input.classList.remove('filled');
            });
            
            // Reset progress
            document.getElementById('decryptProgress').classList.remove('show');
            document.getElementById('decryptProgressFill').style.width = '0%';
            document.getElementById('decryptProgressPercent').textContent = '0%';
            document.getElementById('decryptBtn').disabled = true;
            
            // Show modal
            document.getElementById('fileViewerModal').classList.add('active');
        }

        function moveViewerPinFocus(current) {
            const inputs = document.querySelectorAll('#viewerPinContainer .pin-digit');
            const currentInput = inputs[current - 1];
            
            if (currentInput.value && current < 4) {
                inputs[current].focus();
            }
            
            // Check if PIN is complete
            let pin = '';
            inputs.forEach(input => {
                pin += input.value;
                if (input.value) {
                    input.classList.add('filled');
                } else {
                    input.classList.remove('filled');
                }
            });
            
            viewerPIN = pin;
            document.getElementById('decryptBtn').disabled = pin.length !== 4;
        }

        async function decryptAndViewFile() {
            if (viewerPIN.length !== 4) {
                showToast('‡ß™-‡¶°‡¶ø‡¶ú‡¶ø‡¶ü PIN ‡¶¶‡¶ø‡¶®', 'error');
                return;
            }
            
            if (!currentViewingFile) {
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ', 'error');
                return;
            }
            
            const decryptBtn = document.getElementById('decryptBtn');
            const progressContainer = document.getElementById('decryptProgress');
            const progressFill = document.getElementById('decryptProgressFill');
            const progressText = document.getElementById('decryptProgressText');
            const progressPercent = document.getElementById('decryptProgressPercent');
            
            decryptBtn.disabled = true;
            progressContainer.classList.add('show');
            progressText.textContent = '‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
            
            try {
                // Show progress
                progressFill.style.width = '30%';
                progressPercent.textContent = '30%';
                
                // Get encrypted data
                let encryptedData;
                if (currentViewingFile.encryptedData) {
                    encryptedData = currentViewingFile.encryptedData;
                } else if (currentViewingFile.source === 'online') {
                    // Download from Firebase/Database if needed
                    showToast('‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                    encryptedData = await downloadFromStorage(currentViewingFile);
                }
                
                if (!encryptedData) {
                    throw new Error('Encrypted data not found');
                }
                
                progressFill.style.width = '60%';
                progressPercent.textContent = '60%';
                
                // Decrypt file
                const decryptedFile = await decryptFile(encryptedData, viewerPIN, currentViewingFile.metadata);
                
                progressFill.style.width = '90%';
                progressPercent.textContent = '90%';
                
                // Display file based on type
                await displayFile(decryptedFile, currentViewingFile.metadata?.fileType);
                
                progressFill.style.width = '100%';
                progressPercent.textContent = '100%';
                progressText.textContent = '‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£!';
                
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
                
            } catch (error) {
                console.error('Decryption error:', error);
                progressText.textContent = '‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•';
                
                if (error.message.includes('bad')) {
                    showToast('‡¶≠‡ßÅ‡¶≤ PIN‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                } else {
                    showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•', 'error');
                }
                
                // Reset button
                setTimeout(() => {
                    decryptBtn.disabled = false;
                }, 2000);
            }
        }

        async function decryptFile(encryptedData, pin, metadata) {
            try {
                // Convert encrypted data to Uint8Array
                const encryptedArray = new Uint8Array(encryptedData);
                
                // Extract salt (first 16 bytes)
                const salt = encryptedArray.slice(0, 16);
                
                // Extract IV (next 12 bytes)
                const iv = encryptedArray.slice(16, 28);
                
                // Extract actual encrypted data (rest)
                const ciphertext = encryptedArray.slice(28);
                
                // Derive key from PIN
                const encoder = new TextEncoder();
                const pinBuffer = encoder.encode(pin);
                const combined = new Uint8Array(pinBuffer.length + salt.length);
                combined.set(pinBuffer);
                combined.set(salt, pinBuffer.length);
                
                const hashBuffer = await crypto.subtle.digest('SHA-256', combined);
                const key = await crypto.subtle.importKey(
                    'raw',
                    hashBuffer,
                    { name: 'AES-GCM' },
                    false,
                    ['decrypt']
                );
                
                // Decrypt
                const decryptedBuffer = await crypto.subtle.decrypt(
                    { name: 'AES-GCM', iv: iv },
                    key,
                    ciphertext
                );
                
                return new Blob([decryptedBuffer], { type: metadata?.fileType || 'application/octet-stream' });
                
            } catch (error) {
                console.error('Decryption process error:', error);
                throw new Error('Decryption failed: ' + error.message);
            }
        }

        async function displayFile(blob, fileType) {
            const container = document.getElementById('filePreviewContainer');
            container.innerHTML = '';
            
            if (fileType && fileType.startsWith('image/')) {
                // Display image
                const img = document.createElement('img');
                img.src = URL.createObjectURL(blob);
                img.style.maxWidth = '100%';
                img.style.maxHeight = '100%';
                img.style.objectFit = 'contain';
                container.appendChild(img);
                
                // Add download button
                addDownloadButton(blob);
                
            } else if (fileType && fileType.startsWith('video/')) {
                // Display video
                const video = document.createElement('video');
                video.src = URL.createObjectURL(blob);
                video.controls = true;
                video.style.maxWidth = '100%';
                video.style.maxHeight = '100%';
                container.appendChild(video);
                
                // Add download button
                addDownloadButton(blob);
                
            } else if (fileType && fileType.startsWith('audio/')) {
                // Display audio
                const audio = document.createElement('audio');
                audio.src = URL.createObjectURL(blob);
                audio.controls = true;
                audio.style.width = '100%';
                container.appendChild(audio);
                
                // Add download button
                addDownloadButton(blob);
                
            } else if (fileType === 'application/pdf') {
                // Display PDF (using object tag)
                const object = document.createElement('object');
                object.data = URL.createObjectURL(blob);
                object.type = 'application/pdf';
                object.style.width = '100%';
                object.style.height = '100%';
                container.appendChild(object);
                
                // Add download button
                addDownloadButton(blob);
                
            } else {
                // Generic file display
                const icon = document.createElement('div');
                icon.className = 'empty-icon';
                icon.textContent = 'üìÑ';
                icon.style.fontSize = '5rem';
                container.appendChild(icon);
                
                const message = document.createElement('div');
                message.textContent = '‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§';
                message.style.marginTop = '20px';
                message.style.color = 'var(--text)';
                container.appendChild(message);
                
                // Add download button
                addDownloadButton(blob);
            }
        }

        function addDownloadButton(blob) {
            const container = document.getElementById('filePreviewContainer');
            
            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'btn btn-primary mt-3';
            downloadBtn.innerHTML = '<span class="btn-icon">üì•</span> ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®';
            downloadBtn.onclick = () => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = currentViewingFile.metadata?.fileName || 'decrypted_file';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
            };
            
            // Add to container if not already present
            if (!container.querySelector('.download-btn')) {
                downloadBtn.classList.add('download-btn');
                container.appendChild(downloadBtn);
            }
        }

        async function downloadFromStorage(file) {
            // This function would download from Firebase Storage or other online storage
            // For now, we'll show an error as we need storage implementation
            throw new Error('Online file download not implemented yet');
        }

        // ================================================
        // ENCRYPTION & UPLOAD
        // ================================================
        function openUploadModal() {
            resetUploadModal();
            document.getElementById('uploadModal').classList.add('active');
            
            // Check file size limits
            const cacheLimit = settings.cacheLimit * 1024 * 1024; // Convert to bytes
            const currentSize = getCurrentStorageSize();
            
            if (currentSize > cacheLimit * 0.8) {
                showToast('‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶™‡ßç‡¶∞‡¶æ‡ßü ‡¶™‡ßÇ‡¶∞‡ßç‡¶£! ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®‡•§', 'warning');
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function selectUploadType(type) {
            selectedUploadType = type;
            
            // Update UI
            document.querySelectorAll('.upload-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.closest('.upload-option').classList.add('selected');
            
            // Update file input
            if (type === 'single') {
                document.getElementById('fileInput').classList.remove('d-none');
                document.getElementById('folderInput').classList.add('d-none');
                document.getElementById('dropText').textContent = '‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡ßç‡¶∞‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®';
            } else {
                document.getElementById('fileInput').classList.add('d-none');
                document.getElementById('folderInput').classList.remove('d-none');
                document.getElementById('dropText').textContent = '‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡ßç‡¶∞‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®';
            }
        }

        // File selection handling
        document.getElementById('fileInput').addEventListener('change', handleFileSelect);
        document.getElementById('folderInput').addEventListener('change', handleFileSelect);
        
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            
            // Filter files by type and size
            const validFiles = files.filter(file => {
                // Check file type
                if (CONFIG.allowedFileTypes.length > 0 && 
                    !CONFIG.allowedFileTypes.includes(file.type) && 
                    file.type !== '') {
                    showToast(`${file.name}: ‡¶Ö‡¶®‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ü‡¶æ‡¶á‡¶™`, 'error');
                    return false;
                }
                
                // Check file size
                if (file.size > CONFIG.maxFileSize) {
                    showToast(`${file.name}: ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ${formatFileSize(CONFIG.maxFileSize)} ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá`, 'error');
                    return false;
                }
                
                return true;
            });
            
            selectedFiles = validFiles;
            updateSelectedFilesUI();
            
            if (validFiles.length > 0) {
                showToast(`${validFiles.length}‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá`, 'success');
            }
        }

        function updateSelectedFilesUI() {
            if (selectedFiles.length === 0) {
                document.getElementById('selectedFiles').classList.add('d-none');
                return;
            }
            
            document.getElementById('selectedFiles').classList.remove('d-none');
            const totalSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
            const fileList = document.getElementById('fileList');
            
            if (selectedFiles.length > 5) {
                fileList.textContent = `${selectedFiles.length}‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ (${formatFileSize(totalSize)})`;
            } else {
                fileList.innerHTML = selectedFiles.map(file => 
                    `<div>‚Ä¢ ${file.name} (${formatFileSize(file.size)})</div>`
                ).join('');
            }
        }

        // Drag and drop
        const dropArea = document.getElementById('fileDropArea');
        dropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropArea.classList.add('dragover');
        });

        dropArea.addEventListener('dragleave', () => {
            dropArea.classList.remove('dragover');
        });

        dropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            dropArea.classList.remove('dragover');
            
            let files = [];
            if (e.dataTransfer.items) {
                const items = Array.from(e.dataTransfer.items);
                files = items
                    .filter(item => item.kind === 'file')
                    .map(item => item.getAsFile())
                    .filter(file => file);
            } else {
                files = Array.from(e.dataTransfer.files);
            }
            
            // Filter files
            const validFiles = files.filter(file => {
                if (CONFIG.allowedFileTypes.length > 0 && 
                    !CONFIG.allowedFileTypes.includes(file.type) && 
                    file.type !== '') {
                    showToast(`${file.name}: ‡¶Ö‡¶®‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ü‡¶æ‡¶á‡¶™`, 'error');
                    return false;
                }
                
                if (file.size > CONFIG.maxFileSize) {
                    showToast(`${file.name}: ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ${formatFileSize(CONFIG.maxFileSize)} ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá`, 'error');
                    return false;
                }
                
                return true;
            });
            
            selectedFiles = validFiles;
            updateSelectedFilesUI();
            
            if (validFiles.length > 0) {
                showToast(`${validFiles.length}‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá`, 'success');
            }
        });

        // PIN handling
        function movePinFocus(current) {
            const inputs = document.querySelectorAll('#uploadModal .pin-digit');
            const currentInput = inputs[current - 1];
            
            if (currentInput.value && current < 4) {
                inputs[current].focus();
            }
            
            // Check if PIN is complete
            let pin = '';
            inputs.forEach(input => {
                pin += input.value;
                if (input.value) {
                    input.classList.add('filled');
                } else {
                    input.classList.remove('filled');
                }
            });
            
            currentPIN = pin;
            document.getElementById('startUploadBtn').disabled = pin.length !== 4;
        }

        // Start encryption process
        async function startEncryption() {
            if (selectedFiles.length === 0) {
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
                return;
            }
            
            if (currentPIN.length !== 4) {
                showToast('‡ß™-‡¶°‡¶ø‡¶ú‡¶ø‡¶ü PIN ‡¶¶‡¶ø‡¶®', 'error');
                return;
            }
            
            // Check storage limit
            const cacheLimit = settings.cacheLimit * 1024 * 1024;
            const currentSize = getCurrentStorageSize();
            const newFilesSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
            
            if (currentSize + newFilesSize > cacheLimit) {
                showToast('‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶∏‡ßÄ‡¶Æ‡¶æ ‡¶Ö‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶Æ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá!', 'error');
                return;
            }
            
            // Show progress
            const progressContainer = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const progressPercent = document.getElementById('progressPercent');
            
            progressContainer.classList.add('show');
            const startBtn = document.getElementById('startUploadBtn');
            startBtn.disabled = true;
            startBtn.innerHTML = '<span class="btn-icon">‚è≥</span> ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶æ‡¶ß‡ßÄ‡¶®...';
            
            let processed = 0;
            let successful = 0;
            const total = selectedFiles.length;
            
            for (const file of selectedFiles) {
                try {
                    // Update progress
                    processed++;
                    const percent = Math.round((processed / total) * 100);
                    progressFill.style.width = `${percent}%`;
                    progressPercent.textContent = `${percent}%`;
                    progressText.textContent = `‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶æ‡¶ß‡ßÄ‡¶®: ${file.name}`;
                    
                    // Encrypt file
                    const encryptedData = await encryptFile(file, currentPIN);
                    
                    // Save offline
                    await saveFileOffline(file, encryptedData);
                    successful++;
                    
                    // Add to sync queue if online and auto-sync enabled
                    if (isOnline && currentUser && currentUser.uid !== 'offline_user' && settings.autoSync) {
                        syncQueue.push({ file, encryptedData });
                    }
                    
                } catch (error) {
                    console.error('File processing error:', error);
                    showToast(`${file.name}: ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶æ‡¶ú‡¶æ‡¶§‡¶ï‡¶∞‡¶£ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•`, 'error');
                }
            }
            
            // Complete
            progressText.textContent = '‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!';
            startBtn.innerHTML = '<span class="btn-icon">‚úÖ</span> ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£!';
            
            if (successful > 0) {
                showToast(`${successful}/${total} ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá`, 'success');
                
                // Auto sync if online
                if (isOnline && syncQueue.length > 0 && settings.autoSync) {
                    setTimeout(() => {
                        showToast('‡¶Ö‡¶ü‡ßã ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                        startSync();
                    }, 2000);
                }
            }
            
            // Reload files and close modal
            setTimeout(() => {
                loadFiles();
                closeModal('uploadModal');
                resetUploadModal();
            }, 2000);
        }

        async function encryptFile(file, pin) {
            // Generate salt
            const salt = crypto.getRandomValues(new Uint8Array(16));
            
            // Derive key from PIN
            const encoder = new TextEncoder();
            const pinBuffer = encoder.encode(pin);
            const combined = new Uint8Array(pinBuffer.length + salt.length);
            combined.set(pinBuffer);
            combined.set(salt, pinBuffer.length);
            
            const hashBuffer = await crypto.subtle.digest('SHA-256', combined);
            const key = await crypto.subtle.importKey(
                'raw',
                hashBuffer,
                { name: 'AES-GCM' },
                false,
                ['encrypt']
            );
            
            // Generate IV
            const iv = crypto.getRandomValues(new Uint8Array(12));
            
            // Read and encrypt file
            const fileBuffer = await file.arrayBuffer();
            const encryptedBuffer = await crypto.subtle.encrypt(
                { name: 'AES-GCM', iv: iv },
                key,
                fileBuffer
            );
            
            // Combine salt + iv + encrypted data
            const result = new Uint8Array(salt.length + iv.length + encryptedBuffer.byteLength);
            result.set(salt);
            result.set(iv, salt.length);
            result.set(new Uint8Array(encryptedBuffer), salt.length + iv.length);
            
            return {
                encryptedData: result.buffer,
                metadata: {
                    fileName: file.name,
                    fileType: file.type,
                    fileSize: file.size,
                    salt: Array.from(salt),
                    iv: Array.from(iv),
                    createdAt: new Date().toISOString()
                }
            };
        }

        async function saveFileOffline(file, encryptedData) {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open('HybridVaultDB', 3);
                
                request.onsuccess = (e) => {
                    const db = e.target.result;
                    const transaction = db.transaction(['files'], 'readwrite');
                    const store = transaction.objectStore('files');
                    
                    const fileRecord = {
                        id: 'offline_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                        fileName: file.name,
                        fileType: file.type,
                        fileSize: file.size,
                        encryptedData: encryptedData.encryptedData,
                        metadata: encryptedData.metadata,
                        createdAt: new Date().toISOString(),
                        source: 'offline',
                        needsSync: true,
                        syncAttempts: 0
                    };
                    
                    const addRequest = store.add(fileRecord);
                    
                    addRequest.onsuccess = () => {
                        // Cleanup if over limit
                        if (settings.autoCleanup) {
                            cleanupOldFiles();
                        }
                        resolve();
                    };
                    
                    addRequest.onerror = () => reject(addRequest.error);
                };
                
                request.onerror = () => reject(request.error);
            });
        }

        function resetUploadModal() {
            selectedFiles = [];
            currentPIN = '';
            selectedUploadType = 'single';
            
            // Reset UI
            document.querySelectorAll('#uploadModal .pin-digit').forEach(input => {
                input.value = '';
                input.classList.remove('filled');
            });
            
            document.getElementById('selectedFiles').classList.add('d-none');
            document.getElementById('uploadProgress').classList.remove('show');
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressPercent').textContent = '0%';
            
            const startBtn = document.getElementById('startUploadBtn');
            startBtn.disabled = true;
            startBtn.innerHTML = '<span class="btn-icon">üîí</span> ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®';
            
            // Reset file inputs
            document.getElementById('fileInput').value = '';
            document.getElementById('folderInput').value = '';
            
            // Reset upload options
            document.querySelectorAll('.upload-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector('.upload-option').classList.add('selected');
        }

        // ================================================
        // SYNC & BACKUP
        // ================================================
        async function startSync() {
            if (syncInProgress) {
                showToast('‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ö‡¶≤‡¶õ‡ßá', 'info');
                return;
            }
            
            if (syncQueue.length === 0) {
                showToast('‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡ßá‡¶á', 'info');
                return;
            }
            
            if (!isOnline) {
                showToast('‡¶∏‡¶ø‡¶ô‡ßç‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶•‡¶æ‡¶ï‡ßÅ‡¶®', 'error');
                return;
            }
            
            if (!currentUser || currentUser.uid === 'offline_user') {
                showToast('‡¶∏‡¶ø‡¶ô‡ßç‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
                return;
            }
            
            syncInProgress = true;
            showSyncStatus();
            showToast('‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
            
            try {
                // Initialize Google Drive
                await initGoogleAPIs();
                
                let successful = 0;
                const total = syncQueue.length;
                
                // Process sync queue
                for (let i = 0; i < syncQueue.length; i++) {
                    const item = syncQueue[i];
                    
                    try {
                        showToast(`${i + 1}/${total}: ${item.file.name}`, 'info');
                        await uploadToDrive(item.file, item.encryptedData);
                        successful++;
                        
                        // Mark as synced in IndexedDB
                        await markFileAsSynced(item);
                        
                    } catch (error) {
                        console.error('Sync item error:', error);
                        showToast(`${item.file.name}: ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•`, 'error');
                        
                        // Update sync attempts
                        await updateSyncAttempts(item);
                    }
                }
                
                // Clear queue
                syncQueue = [];
                
                if (successful > 0) {
                    showToast(`${successful}‡¶ü‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶π‡ßü‡ßá‡¶õ‡ßá`, 'success');
                    loadFiles(); // Reload to update UI
                }
                
            } catch (error) {
                console.error('Sync error:', error);
                showToast('‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•: ' + error.message, 'error');
            } finally {
                syncInProgress = false;
                hideSyncStatus();
            }
        }

        async function initGoogleAPIs() {
            // Already initialized check
            if (window.gapi && window.gapi.client && window.gapi.client.drive) {
                return;
            }
            
            // Load Google API client
            await new Promise((resolve) => {
                gapi.load('client', resolve);
            });
            
            // Initialize client
            await gapi.client.init({
                apiKey: CONFIG.firebase.apiKey,
                discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
            });
            
            // Initialize token client
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CONFIG.googleClientId,
                scope: 'https://www.googleapis.com/auth/drive.file',
                callback: async (response) => {
                    if (response.error) {
                        throw new Error('Drive access denied: ' + response.error);
                    }
                    googleUser = response;
                },
            });
            
            // Request token if not present
            if (!googleUser || !googleUser.access_token) {
                tokenClient.requestAccessToken();
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }

        async function uploadToDrive(file, encryptedData) {
            const metadata = {
                name: `vault_${Date.now()}_${file.name}.enc`,
                parents: [CONFIG.googleDrive.folderId],
                mimeType: 'application/octet-stream',
                description: `Encrypted via ${CONFIG.appName} v${CONFIG.version}`,
                appProperties: {
                    vaultApp: CONFIG.appName,
                    vaultVersion: CONFIG.version,
                    originalName: file.name,
                    encryptedAt: new Date().toISOString()
                }
            };
            
            const form = new FormData();
            form.append('metadata', new Blob([JSON.stringify(metadata)], { 
                type: 'application/json' 
            }));
            form.append('file', new Blob([encryptedData.encryptedData], { 
                type: 'application/octet-stream' 
            }));
            
            const response = await fetch(
                'https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,webViewLink',
                {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${googleUser.access_token}`
                    },
                    body: form
                }
            );
            
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`Drive upload failed: ${response.status} - ${errorText}`);
            }
            
            const result = await response.json();
            
            // Save to Firestore
            await db.collection('files').add({
                driveFileId: result.id,
                ownerId: currentUser.uid,
                fileName: file.name,
                fileType: file.type,
                fileSize: file.size,
                metadata: encryptedData.metadata,
                driveLink: result.webViewLink,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                source: 'drive',
                syncStatus: 'completed'
            });
            
            return result.id;
        }

        async function markFileAsSynced(item) {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open('HybridVaultDB', 3);
                
                request.onsuccess = (e) => {
                    const db = e.target.result;
                    const transaction = db.transaction(['files'], 'readwrite');
                    const store = transaction.objectStore('files');
                    
                    // We need to find the file by some identifier
                    // This is simplified - in real app you'd have proper ID
                    const index = store.index('createdAt');
                    const cursorRequest = index.openCursor(null, 'prev');
                    
                    cursorRequest.onsuccess = (event) => {
                        const cursor = event.target.result;
                        if (cursor) {
                            if (cursor.value.fileName === item.file.name && 
                                cursor.value.needsSync) {
                                cursor.value.needsSync = false;
                                cursor.value.syncAttempts = 0;
                                cursor.update(cursor.value);
                            }
                            cursor.continue();
                        } else {
                            resolve();
                        }
                    };
                };
                
                request.onerror = () => reject(request.error);
            });
        }

        async function updateSyncAttempts(item) {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open('HybridVaultDB', 3);
                
                request.onsuccess = (e) => {
                    const db = e.target.result;
                    const transaction = db.transaction(['files'], 'readwrite');
                    const store = transaction.objectStore('files');
                    
                    const index = store.index('createdAt');
                    const cursorRequest = index.openCursor(null, 'prev');
                    
                    cursorRequest.onsuccess = (event) => {
                        const cursor = event.target.result;
                        if (cursor) {
                            if (cursor.value.fileName === item.file.name) {
                                cursor.value.syncAttempts = (cursor.value.syncAttempts || 0) + 1;
                                if (cursor.value.syncAttempts > 3) {
                                    cursor.value.needsSync = false; // Stop trying after 3 attempts
                                }
                                cursor.update(cursor.value);
                            }
                            cursor.continue();
                        } else {
                            resolve();
                        }
                    };
                };
            });
        }

        function showSyncStatus() {
            document.getElementById('syncStatus').classList.add('show');
        }

        function hideSyncStatus() {
            document.getElementById('syncStatus').classList.remove('show');
        }

        // ================================================
        // SETTINGS MANAGEMENT
        // ================================================
        function loadSettings() {
            const saved = localStorage.getItem('hybridVaultSettings');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    settings = { ...settings, ...parsed };
                    
                    // Update UI
                    document.getElementById('autoSyncToggle').checked = settings.autoSync;
                    document.getElementById('offlineWarningToggle').checked = settings.offlineWarning;
                    document.getElementById('pinHintToggle').checked = settings.pinHint;
                    document.getElementById('cacheLimitSelect').value = settings.cacheLimit;
                    document.getElementById('autoCleanupToggle').checked = settings.autoCleanup;
                    document.getElementById('autoLogoutSelect').value = settings.autoLogout;
                    document.getElementById('multiDeviceToggle').checked = settings.multiDevice;
                    
                } catch (e) {
                    console.error('Settings load error:', e);
                }
            }
        }

        function saveSettings() {
            // Update settings from UI
            settings.autoSync = document.getElementById('autoSyncToggle').checked;
            settings.offlineWarning = document.getElementById('offlineWarningToggle').checked;
            settings.pinHint = document.getElementById('pinHintToggle').checked;
            settings.cacheLimit = parseInt(document.getElementById('cacheLimitSelect').value);
            settings.autoCleanup = document.getElementById('autoCleanupToggle').checked;
            settings.autoLogout = parseInt(document.getElementById('autoLogoutSelect').value);
            settings.multiDevice = document.getElementById('multiDeviceToggle').checked;
            
            // Save to localStorage
            localStorage.setItem('hybridVaultSettings', JSON.stringify(settings));
            
            // Apply changes
            if (settings.autoLogout > 0) {
                initInactivityTimer();
            } else if (inactivityTimer) {
                clearTimeout(inactivityTimer);
                inactivityTimer = null;
            }
            
            showToast('‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
        }

        function initInactivityTimer() {
            if (inactivityTimer) {
                clearTimeout(inactivityTimer);
            }
            
            inactivityTimer = setTimeout(() => {
                if (currentUser && currentUser.uid !== 'offline_user') {
                    showToast('‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶§‡¶æ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'warning');
                    setTimeout(() => signOut(), 3000);
                }
            }, settings.autoLogout * 60 * 1000);
        }

        function resetInactivityTimer() {
            if (settings.autoLogout > 0) {
                initInactivityTimer();
            }
        }

        function clearLocalCache() {
            if (confirm('‡¶∏‡¶ï‡¶≤ ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®? ‡¶è‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶π‡¶¨‡ßá ‡¶®‡¶æ‡•§')) {
                const request = indexedDB.deleteDatabase('HybridVaultDB');
                
                request.onsuccess = () => {
                    showToast('‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá', 'success');
                    loadFiles(); // Reload empty state
                };
                
                request.onerror = () => {
                    showToast('‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•', 'error');
                };
            }
        }

        function getCurrentStorageSize() {
            // This would calculate total size of IndexedDB
            // Simplified version - in real app you'd sum all file sizes
            return 0;
        }

        function cleanupOldFiles() {
            // This would clean old files when autoCleanup is enabled
            // Implementation depends on your specific needs
            console.log('Auto cleanup triggered');
        }

        // ================================================
        // TAB SWITCHING
        // ================================================
        function switchTab(tab) {
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Handle tab switch
            switch(tab) {
                case 'gallery':
                    loadFiles();
                    break;
                    
                case 'drive':
                    if (isOnline && currentUser && currentUser.uid !== 'offline_user') {
                        showToast('‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', 'info');
                        // Load drive-specific files
                        loadDriveFiles();
                    } else {
                        showToast('‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶ì ‡¶≤‡¶ó‡¶á‡¶® ‡¶•‡¶æ‡¶ï‡ßÅ‡¶®', 'warning');
                    }
                    break;
                    
                case 'backup':
                    if (isOnline && currentUser && currentUser.uid !== 'offline_user') {
                        startSync();
                    } else {
                        showToast('‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶ì ‡¶≤‡¶ó‡¶á‡¶® ‡¶•‡¶æ‡¶ï‡ßÅ‡¶®', 'warning');
                    }
                    break;
                    
                case 'settings':
                    openSettings();
                    break;
            }
        }

        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
        }

        async function loadDriveFiles() {
            try {
                const snapshot = await db.collection('files')
                    .where('ownerId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                const driveFiles = snapshot.docs.map(doc => ({
                    ...doc.data(),
                    id: doc.id,
                    source: 'drive'
                }));
                
                updateFileGrid(driveFiles);
                showToast(`${driveFiles.length}‡¶ü‡¶ø ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá`, 'success');
                
            } catch (error) {
                console.error('Drive files load error:', error);
                showToast('‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•', 'error');
            }
        }

        // ================================================
        // UTILITY FUNCTIONS
        // ================================================
        function formatFileSize(bytes) {
            if (bytes === 0 || !bytes) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('bn-BD', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function showToast(message, type = 'info') {
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            const toastContainer = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${getToastIcon(type)}</div>
                <div class="toast-content">
                    <div class="toast-message">${message}</div>
                </div>
                <div class="toast-progress"></div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Remove toast after animation
            setTimeout(() => {
                toast.classList.add('hide');
                setTimeout(() => {
                    toast.remove();
                }, 500);
            }, 3000);
        }

        function getToastIcon(type) {
            switch(type) {
                case 'success': return '‚úÖ';
                case 'error': return '‚ùå';
                case 'warning': return '‚ö†Ô∏è';
                case 'info': return '‚ÑπÔ∏è';
                default: return 'üí°';
            }
        }

        // ================================================
        // EVENT LISTENERS
        // ================================================
        document.addEventListener('DOMContentLoaded', initApp);
        document.getElementById('googleSignInBtn').addEventListener('click', signInWithGoogle);
        document.getElementById('offlineModeBtn').addEventListener('click', startOfflineMode);
        document.getElementById('quickUploadBtn').addEventListener('click', openUploadModal);
        document.getElementById('syncDriveBtn').addEventListener('click', startSync);

        // Settings change listeners
        document.getElementById('autoSyncToggle').addEventListener('change', saveSettings);
        document.getElementById('offlineWarningToggle').addEventListener('change', saveSettings);
        document.getElementById('pinHintToggle').addEventListener('change', saveSettings);
        document.getElementById('cacheLimitSelect').addEventListener('change', saveSettings);
        document.getElementById('autoCleanupToggle').addEventListener('change', saveSettings);
        document.getElementById('autoLogoutSelect').addEventListener('change', saveSettings);
        document.getElementById('multiDeviceToggle').addEventListener('change', saveSettings);

        // User activity tracking for auto logout
        ['click', 'mousemove', 'keypress', 'scroll', 'touchstart'].forEach(event => {
            document.addEventListener(event, resetInactivityTimer);
        });

        // Initialize PIN inputs
        document.addEventListener('DOMContentLoaded', () => {
            const pinInputs = document.querySelectorAll('.pin-digit');
            pinInputs.forEach((input, index) => {
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' && !input.value && index > 0) {
                        pinInputs[index - 1].focus();
                    }
                });
                
                input.addEventListener('paste', (e) => {
                    e.preventDefault();
                    const paste = e.clipboardData.getData('text').slice(0, 4);
                    pinInputs.forEach((pinInput, i) => {
                        if (paste[i]) {
                            pinInput.value = paste[i];
                            pinInput.classList.add('filled');
                        }
                    });
                    if (pinInputs[3]) pinInputs[3].focus();
                });
            });
        });

        // ================================================
        // TOAST NOTIFICATION SYSTEM EXPLANATION
        // ================================================
        /*
        Toast Notification System ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá:
        
        1. SUCCESS (‚úÖ): 
           - ‡¶∏‡¶´‡¶≤ ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶® (‡¶≤‡¶ó‡¶á‡¶®, ‡¶Ü‡¶™‡¶≤‡ßã‡¶°, ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï, ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡ßá‡¶≠)
           - ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: "‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá"
        
        2. ERROR (‚ùå): 
           - ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶∂‡¶® (‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•, ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•, ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶è‡¶∞‡¶∞)
           - ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: "‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• - ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ"
        
        3. WARNING (‚ö†Ô∏è): 
           - ‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ (‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°, ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶´‡ßÅ‡¶≤, ‡¶∏‡ßÄ‡¶Æ‡¶æ‡¶¨‡¶¶‡ßç‡¶ß‡¶§‡¶æ)
           - ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: "‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶° - ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶π‡¶¨‡ßá"
        
        4. INFO (‚ÑπÔ∏è): 
           - ‡¶§‡¶•‡ßç‡¶Ø‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú (‡¶≤‡ßã‡¶°‡¶ø‡¶Ç, ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç, ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏)
           - ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: "‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."
        
        Toast ‡¶ó‡ßÅ‡¶≤‡¶ø:
        - ‡ß© ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü
        - ‡¶∏‡ßç‡¶¨‡ßü‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶π‡ßü
        - ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶¨‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü
        - Stack ‡¶π‡ßü (‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá)
        - Responsive design
        */

        // ================================================
        // GOOGLE WARNING ISSUE SOLUTION
        // ================================================
        /*
        Google ‡¶Ø‡ßá Warning ‡¶¶‡ßá‡ßü ‡¶§‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£:
        
        1. FILE ACCESS PERMISSION:
           - ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ API "drive.file" scope ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡ßá
           - ‡¶è‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ user-selected ‡¶´‡¶æ‡¶á‡¶≤ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
           - ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶¶‡¶ø‡¶§‡ßá "drive" scope ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞
           ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶∏‡ßá‡¶ü‡¶æ verification ‡¶≤‡¶æ‡¶ó‡¶æ‡ßü
        
        ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶®:
        - ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ
        - User consent screen ‡¶è ‡¶∏‡ßç‡¶™‡¶∑‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¶‡ßá‡ßü‡¶æ
        - Privacy policy ‡¶ì terms of service ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
        - Google API Console ‡¶è verification ‡¶ï‡¶∞‡¶æ‡¶®‡ßã
        
        ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ:
        - ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶ø "drive.file" scope ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá
        - ‡¶∂‡ßÅ‡¶ß‡ßÅ user-selected ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°/‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
        - ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶®‡ßá‡¶á, ‡¶§‡¶æ‡¶á warning ‡¶ï‡¶Æ
        */
    </script>
</body>
</html>